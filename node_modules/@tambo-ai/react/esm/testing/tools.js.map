{"version":3,"file":"tools.js","sourceRoot":"","sources":["../../src/testing/tools.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,gBAAgB,EAAE,sBAAsB,EAAE,MAAM,WAAW,CAAC;AACrE,OAAO,EAAE,yBAAyB,EAAE,MAAM,kBAAkB,CAAC;AAE7D;;;;;;GAMG;AACH,MAAM,UAAU,iBAAiB,CAAC,YAA8B;IAC9D,OAAO,YAAY,CAAC,GAAG,CACrB,CAAC,EACC,SAAS,EAAE,UAAU,EACrB,WAAW,EACX,eAAe,EACf,GAAG,cAAc,EAClB,EAAE,EAAE,CAAC,CAAC;QACL,GAAG,cAAc;QACjB,KAAK,EAAE,gBAAgB,CAAC,WAAW,CAAC;YAClC,CAAC,CAAC,sBAAsB,CAAC,WAAW,CAAC;YACrC,CAAC,CAAC,WAAW;QACf,YAAY,EAAE,eAAe,EAAE,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAC1C,yBAAyB,CAAC,IAAI,CAAC,CAChC;KACF,CAAC,CACH,CAAC;AACJ,CAAC;AAQD,mDAAmD;AACnD;;;;;;GAMG;AACH,MAAM,UAAU,cAAc,CAC5B,eAAiE;IAEjE,qCAAqC;IACrC,MAAM,sBAAsB,GAAG,CAC7B,GAAY,EACkB,EAAE;QAChC,OAAO,CACL,OAAO,GAAG,KAAK,QAAQ;YACvB,GAAG,KAAK,IAAI;YACZ,aAAa,IAAI,GAAG;YACpB,GAAG,CAAC,WAAW,IAAI,IAAI,CACxB,CAAC;IACJ,CAAC,CAAC;IAEF,IAAI,sBAAsB,CAAC,eAAe,CAAC,EAAE,CAAC;QAC5C,OAAO;YACL,IAAI,EAAE,UAAU;YAChB,WAAW,EAAE,yBAAyB;YACtC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,GAAG,EAAE,GAAE,CAAC,CAAC;YAC5C,WAAW,EAAE,eAAe,CAAC,WAAW;YACxC,YAAY,EAAE,eAAe,CAAC,YAAY,IAAI;gBAC5C,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE,EAAE;aACf;YACD,GAAG,CAAC,eAAe,CAAC,QAAQ,KAAK,SAAS;gBACxC,CAAC,CAAC,EAAE,QAAQ,EAAE,eAAe,CAAC,QAAQ,EAAE;gBACxC,CAAC,CAAC,EAAE,CAAC;SACR,CAAC;IACJ,CAAC;IAED,OAAO;QACL,IAAI,EAAE,UAAU;QAChB,WAAW,EAAE,yBAAyB;QACtC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,GAAG,EAAE,GAAE,CAAC,CAAC;QAC5C,WAAW,EAAE,eAAe;QAC5B,YAAY,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,EAAE,EAAE,EAAE;KACjD,CAAC;AACJ,CAAC","sourcesContent":["import { TamboComponent, TamboTool } from \"../providers\";\nimport { isStandardSchema, safeSchemaToJsonSchema } from \"../schema\";\nimport { mapTamboToolToContextTool } from \"../util/registry\";\n\n/**\n * Serializes the registry for testing purposes.\n * Converts Standard Schema validators to JSON Schema format.\n * Uses the same logic as production code via mapTamboToolToContextTool.\n * @param mockRegistry - The registry to serialize\n * @returns The serialized registry with JSON Schema representations\n */\nexport function serializeRegistry(mockRegistry: TamboComponent[]) {\n  return mockRegistry.map(\n    ({\n      component: _component,\n      propsSchema,\n      associatedTools,\n      ...componentEntry\n    }) => ({\n      ...componentEntry,\n      props: isStandardSchema(propsSchema)\n        ? safeSchemaToJsonSchema(propsSchema)\n        : propsSchema,\n      contextTools: associatedTools?.map((tool) =>\n        mapTamboToolToContextTool(tool),\n      ),\n    }),\n  );\n}\n\ninterface CreateMockToolOptions {\n  inputSchema: TamboTool[\"inputSchema\"];\n  outputSchema?: TamboTool[\"outputSchema\"];\n  maxCalls?: number;\n}\n\n// Helper to create a minimal TamboTool for testing\n/**\n * Creates a mock TamboTool with the given input schema for testing purposes.\n * Accepts either an inputSchema directly or an options object with inputSchema and outputSchema.\n * @param schemaOrOptions - The input schema or options object\n * @returns A mock TamboTool instance\n * @internal\n */\nexport function createMockTool(\n  schemaOrOptions: TamboTool[\"inputSchema\"] | CreateMockToolOptions,\n): TamboTool {\n  // Check if options object was passed\n  const hasInputSchemaProperty = (\n    obj: unknown,\n  ): obj is CreateMockToolOptions => {\n    return (\n      typeof obj === \"object\" &&\n      obj !== null &&\n      \"inputSchema\" in obj &&\n      obj.inputSchema != null\n    );\n  };\n\n  if (hasInputSchemaProperty(schemaOrOptions)) {\n    return {\n      name: \"mockTool\",\n      description: \"A mock tool for testing\",\n      tool: jest.fn().mockImplementation(() => {}),\n      inputSchema: schemaOrOptions.inputSchema,\n      outputSchema: schemaOrOptions.outputSchema ?? {\n        type: \"object\",\n        properties: {},\n      },\n      ...(schemaOrOptions.maxCalls !== undefined\n        ? { maxCalls: schemaOrOptions.maxCalls }\n        : {}),\n    };\n  }\n\n  return {\n    name: \"mockTool\",\n    description: \"A mock tool for testing\",\n    tool: jest.fn().mockImplementation(() => {}),\n    inputSchema: schemaOrOptions,\n    outputSchema: { type: \"object\", properties: {} },\n  };\n}\n"]}