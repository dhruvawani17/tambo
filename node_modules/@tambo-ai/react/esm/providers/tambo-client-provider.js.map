{"version":3,"file":"tambo-client-provider.js","sourceRoot":"","sources":["../../src/providers/tambo-client-provider.tsx"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,OAAO,OAA0B,MAAM,0BAA0B,CAAC;AAClE,OAAO,EAAE,WAAW,EAAE,MAAM,uBAAuB,CAAC;AACpD,OAAO,KAAK,EAAE,EAAE,aAAa,EAAqB,OAAO,EAAE,MAAM,OAAO,CAAC;AACzE,OAAO,WAAW,MAAM,oBAAoB,CAAC;AAC7C,OAAO,EAAE,oBAAoB,EAAE,MAAM,iCAAiC,CAAC;AA2CvE,MAAM,CAAC,MAAM,kBAAkB,GAAG,aAAa,CAE7C,SAAS,CAAC,CAAC;AAEb;;;;;;;;;;;GAWG;AACH,MAAM,CAAC,MAAM,mBAAmB,GAE5B,CAAC,EACH,QAAQ,EACR,QAAQ,EACR,MAAM,EACN,WAAW,EACX,SAAS,EACT,iBAAiB,GAClB,EAAE,EAAE;IACH,MAAM,WAAW,GAAG,OAAO,CACzB,GAAG,EAAE,CACH,CAAC;QACC,MAAM;QACN,cAAc,EAAE;YACd,uBAAuB,EAAE,WAAW,CAAC,OAAO;YAC5C,GAAG,iBAAiB;SACrB;QACD,OAAO,EAAE,QAAQ,IAAI,SAAS;QAC9B,WAAW,EAAE,WAAW,IAAI,SAAS;KACtC,CAAyB,EAC5B,CAAC,iBAAiB,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,CAAC,CACnD,CAAC;IAEF,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;IACtE,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,IAAI,WAAW,EAAE,EAAE,EAAE,CAAC,CAAC;IAEzD,4DAA4D;IAC5D,MAAM,EAAE,UAAU,EAAE,eAAe,EAAE,GAAG,oBAAoB,CAC1D,MAAM,EACN,WAAW,EACX,SAAS,CACV,CAAC;IAEF,OAAO,CACL,oBAAC,kBAAkB,CAAC,QAAQ,IAC1B,KAAK,EAAE;YACL,MAAM;YACN,WAAW;YACX,eAAe;YACf,iBAAiB,EAAE,WAAW,CAAC,cAAc;SAC9C,IAEA,QAAQ,CACmB,CAC/B,CAAC;AACJ,CAAC,CAAC;AAEF;;;;GAIG;AACH,MAAM,CAAC,MAAM,cAAc,GAAG,GAAG,EAAE;IACjC,MAAM,OAAO,GAAG,KAAK,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;IACrD,IAAI,OAAO,KAAK,SAAS,EAAE,CAAC;QAC1B,MAAM,IAAI,KAAK,CAAC,0DAA0D,CAAC,CAAC;IAC9E,CAAC;IACD,OAAO,OAAO,CAAC,MAAM,CAAC;AACxB,CAAC,CAAC;AAEF;;;;;GAKG;AACH,MAAM,CAAC,MAAM,mBAAmB,GAAG,GAAG,EAAE;IACtC,MAAM,OAAO,GAAG,KAAK,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;IACrD,IAAI,OAAO,KAAK,SAAS,EAAE,CAAC;QAC1B,MAAM,IAAI,KAAK,CACb,+DAA+D,CAChE,CAAC;IACJ,CAAC;IACD,OAAO,OAAO,CAAC,WAAW,CAAC;AAC7B,CAAC,CAAC;AAEF;;;GAGG;AACH,MAAM,CAAC,MAAM,uBAAuB,GAAG,GAAG,EAAE;IAC1C,MAAM,OAAO,GAAG,KAAK,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;IACrD,IAAI,OAAO,KAAK,SAAS,EAAE,CAAC;QAC1B,MAAM,IAAI,KAAK,CACb,mEAAmE,CACpE,CAAC;IACJ,CAAC;IACD,OAAO,OAAO,CAAC,eAAe,CAAC;AACjC,CAAC,CAAC","sourcesContent":["\"use client\";\nimport TamboAI, { ClientOptions } from \"@tambo-ai/typescript-sdk\";\nimport { QueryClient } from \"@tanstack/react-query\";\nimport React, { createContext, PropsWithChildren, useMemo } from \"react\";\nimport packageJson from \"../../package.json\";\nimport { useTamboSessionToken } from \"./hooks/use-tambo-session-token\";\n\nexport interface TamboClientProviderProps {\n  /**\n   * The URL of the Tambo API (only used for local development and debugging)\n   */\n  tamboUrl?: string;\n  /**\n   * The API key for the Tambo API. This typically comes from a variable like\n   * `process.env.NEXT_PUBLIC_TAMBO_API_KEY`\n   */\n  apiKey: string;\n  /**\n   * The environment to use for the Tambo API\n   */\n  environment?: \"production\" | \"staging\";\n\n  /**\n   * The user token to use to identify the user in the Tambo API. This token is\n   * a 3rd party token like a Google or GitHub access token, exchanged with the\n   * Tambo API to get a session token. This is used to securely identify the\n   * user when calling the Tambo API.\n   */\n  userToken?: string;\n\n  /**\n   * Additional headers to include in all requests to the Tambo API.\n   * These will be merged with the default headers.\n   */\n  additionalHeaders?: Record<string, string>;\n}\n\nexport interface TamboClientContextProps {\n  /** The TamboAI client */\n  client: TamboAI;\n  /** The tambo-specific query client */\n  queryClient: QueryClient;\n  /** Whether the session token is currently being updated */\n  isUpdatingToken: boolean;\n  /** Additional headers to include in all requests */\n  additionalHeaders?: Record<string, string>;\n}\n\nexport const TamboClientContext = createContext<\n  TamboClientContextProps | undefined\n>(undefined);\n\n/**\n * The TamboClientProvider is a React provider that provides a TamboAI client\n * and a query client to the descendants of the provider.\n * @param props - The props for the TamboClientProvider\n * @param props.children - The children to wrap\n * @param props.tamboUrl - The URL of the Tambo API\n * @param props.apiKey - The API key for the Tambo API\n * @param props.environment - The environment to use for the Tambo API\n * @param props.userToken - The oauth access token to use to identify the user in the Tambo API\n * @param props.additionalHeaders - Additional headers to include in all requests\n * @returns The TamboClientProvider component\n */\nexport const TamboClientProvider: React.FC<\n  PropsWithChildren<TamboClientProviderProps>\n> = ({\n  children,\n  tamboUrl,\n  apiKey,\n  environment,\n  userToken,\n  additionalHeaders,\n}) => {\n  const tamboConfig = useMemo(\n    () =>\n      ({\n        apiKey,\n        defaultHeaders: {\n          \"X-Tambo-React-Version\": packageJson.version,\n          ...additionalHeaders,\n        },\n        baseURL: tamboUrl ?? undefined,\n        environment: environment ?? undefined,\n      }) satisfies ClientOptions,\n    [additionalHeaders, apiKey, tamboUrl, environment],\n  );\n\n  const client = useMemo(() => new TamboAI(tamboConfig), [tamboConfig]);\n  const queryClient = useMemo(() => new QueryClient(), []);\n\n  // Keep the session token updated and get the updating state\n  const { isFetching: isUpdatingToken } = useTamboSessionToken(\n    client,\n    queryClient,\n    userToken,\n  );\n\n  return (\n    <TamboClientContext.Provider\n      value={{\n        client,\n        queryClient,\n        isUpdatingToken,\n        additionalHeaders: tamboConfig.defaultHeaders,\n      }}\n    >\n      {children}\n    </TamboClientContext.Provider>\n  );\n};\n\n/**\n * The useTamboClient hook provides access to the TamboAI client\n * to the descendants of the TamboClientProvider.\n * @returns The TamboAI client\n */\nexport const useTamboClient = () => {\n  const context = React.useContext(TamboClientContext);\n  if (context === undefined) {\n    throw new Error(\"useTamboClient must be used within a TamboClientProvider\");\n  }\n  return context.client;\n};\n\n/**\n * The useTamboQueryClient hook provides access to the tambo-specific query client\n * to the descendants of the TamboClientProvider.\n * @returns The tambo-specific query client\n * @private\n */\nexport const useTamboQueryClient = () => {\n  const context = React.useContext(TamboClientContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useTamboQueryClient must be used within a TamboClientProvider\",\n    );\n  }\n  return context.queryClient;\n};\n\n/**\n * Hook to check if the session token is currently being updated\n * @returns true if the token is being refreshed, false otherwise\n */\nexport const useIsTamboTokenUpdating = () => {\n  const context = React.useContext(TamboClientContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useIsTamboTokenUpdating must be used within a TamboClientProvider\",\n    );\n  }\n  return context.isUpdatingToken;\n};\n"]}