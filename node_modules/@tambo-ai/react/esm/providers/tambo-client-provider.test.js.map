{"version":3,"file":"tambo-client-provider.test.js","sourceRoot":"","sources":["../../src/providers/tambo-client-provider.test.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,wBAAwB,CAAC;AACpD,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,EACL,mBAAmB,EAEnB,uBAAuB,EACvB,cAAc,EACd,mBAAmB,GACpB,MAAM,yBAAyB,CAAC;AAEjC,8DAA8D;AAC9D,IAAI,CAAC,IAAI,CAAC,iCAAiC,EAAE,GAAG,EAAE,CAAC,CAAC;IAClD,oBAAoB,EAAE,IAAI,CAAC,EAAE,EAAE;CAChC,CAAC,CAAC,CAAC;AAEJ,OAAO,EAAE,oBAAoB,EAAE,MAAM,iCAAiC,CAAC;AAEvE,qEAAqE;AACrE,MAAM,SAAS,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;AAC5B,IAAI,aAA2B,CAAC;AAEhC,UAAU,CAAC,GAAG,EAAE;IACd,SAAS,CAAC,SAAS,EAAE,CAAC;IACtB,aAAa,GAAG,MAAM,CAAC,KAAK,CAAC;IAC7B,MAAM,CAAC,KAAK,GAAG,SAAoC,CAAC;AACtD,CAAC,CAAC,CAAC;AAEH,SAAS,CAAC,GAAG,EAAE;IACb,MAAM,CAAC,KAAK,GAAG,aAAa,CAAC;AAC/B,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACnC,UAAU,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,6BAA6B;QAC7B,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC,eAAe,CAAC;YAChD,UAAU,EAAE,KAAK;YACjB,IAAI,EAAE,SAAS;YACf,KAAK,EAAE,IAAI;YACX,SAAS,EAAE,KAAK;YAChB,OAAO,EAAE,KAAK;YACd,SAAS,EAAE,KAAK;YAChB,MAAM,EAAE,SAAS;YACjB,WAAW,EAAE,MAAM;SACb,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC;IAEH,MAAM,aAAa,GAAG,CAAC,KAA+B,EAAE,EAAE;QACxD,MAAM,OAAO,GAAG,CAAC,EAAE,QAAQ,EAAiC,EAAE,EAAE,CAAC,CAC/D,oBAAC,mBAAmB,OAAK,KAAK,IAAG,QAAQ,CAAuB,CACjE,CAAC;QACF,OAAO,CAAC,WAAW,GAAG,aAAa,CAAC;QACpC,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC;IAEF,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,EAAE,CAAC,yDAAyD,EAAE,GAAG,EAAE;YACjE,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACpD,OAAO,EAAE,aAAa,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC;aACnD,CAAC,CAAC;YAEH,0DAA0D;YAC1D,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;YACrC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,GAAG,EAAE;YAC/D,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBAC9D,OAAO,EAAE,aAAa,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC;aACnD,CAAC,CAAC;YAEH,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC;YACnC,QAAQ,EAAE,CAAC;YACX,MAAM,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC;YAEpC,MAAM,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACpD,OAAO,EAAE,aAAa,CAAC;oBACrB,MAAM,EAAE,cAAc;oBACtB,QAAQ,EAAE,0BAA0B;iBACrC,CAAC;aACH,CAAC,CAAC;YAEH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC;QAClE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE;YACjE,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACpD,OAAO,EAAE,aAAa,CAAC;oBACrB,MAAM,EAAE,cAAc;oBACtB,WAAW,EAAE,SAAS;iBACvB,CAAC;aACH,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC;gBAChD,MAAM,EAAE,KAAK;gBACb,IAAI,EAAE,gBAAgB;aACvB,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4DAA4D,EAAE,GAAG,EAAE;YACpE,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;YAErE,MAAM,CAAC,GAAG,EAAE;gBACV,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;oBACjC,OAAO,EAAE,aAAa,CAAC;wBACrB,MAAM,EAAE,cAAc;wBACtB,QAAQ,EAAE,0BAA0B;wBACpC,WAAW,EAAE,SAAS;qBACvB,CAAC;iBACH,CAAC,CAAC;YACL,CAAC,CAAC,CAAC,OAAO,CACR,2KAA2K,CAC5K,CAAC;YAEF,UAAU,CAAC,WAAW,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACpD,OAAO,EAAE,aAAa,CAAC;oBACrB,MAAM,EAAE,cAAc;oBACtB,iBAAiB,EAAE;wBACjB,iBAAiB,EAAE,cAAc;wBACjC,kBAAkB,EAAE,eAAe;qBACpC;iBACF,CAAC;aACH,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC;gBAChD,MAAM,EAAE,KAAK;gBACb,IAAI,EAAE,gBAAgB;aACvB,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;YAC/D,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,iBAAiB;YAC5F,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAChE,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC,eAAe,CAAC;gBAChD,UAAU,EAAE,IAAI;aACV,CAAC,CAAC;YAEV,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,uBAAuB,EAAE,EAAE;gBAC7D,OAAO,EAAE,aAAa,CAAC;oBACrB,MAAM,EAAE,cAAc;oBACtB,SAAS,EAAE,aAAa;iBACzB,CAAC;aACH,CAAC,CAAC;YAEH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,GAAG,EAAE;YAC/D,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC,eAAe,CAAC;gBAChD,UAAU,EAAE,KAAK;aACX,CAAC,CAAC;YAEV,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,uBAAuB,EAAE,EAAE;gBAC7D,OAAO,EAAE,aAAa,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC;aACnD,CAAC,CAAC;YAEH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;YACvE,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACjC,OAAO,EAAE,aAAa,CAAC;oBACrB,MAAM,EAAE,cAAc;oBACtB,SAAS,EAAE,gBAAgB;iBAC5B,CAAC;aACH,CAAC,CAAC;YAEH,MAAM,CAAC,oBAAoB,CAAC,CAAC,oBAAoB,CAC/C,MAAM,CAAC,QAAQ,EAAE,EAAE,SAAS;YAC5B,MAAM,CAAC,QAAQ,EAAE,EAAE,cAAc;YACjC,gBAAgB,CACjB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;IAC9B,UAAU,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC,eAAe,CAAC;YAChD,UAAU,EAAE,KAAK;SACX,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC;IAEH,MAAM,aAAa,GAAG,CAAC,KAAyB,EAAE,EAAE;QAClD,MAAM,OAAO,GAAG,CAAC,EAAE,QAAQ,EAAiC,EAAE,EAAE,CAAC,CAC/D,oBAAC,mBAAmB,OAAK,KAAK,IAAG,QAAQ,CAAuB,CACjE,CAAC;QACF,OAAO,CAAC,WAAW,GAAG,aAAa,CAAC;QACpC,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC;IAEF,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC9B,EAAE,CAAC,+CAA+C,EAAE,GAAG,EAAE;YACvD,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE;gBACpD,OAAO,EAAE,aAAa,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC;aACnD,CAAC,CAAC;YAEH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;YACrC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,uCAAuC;YACvC,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;YAErE,MAAM,CAAC,GAAG,EAAE;gBACV,UAAU,CAAC,GAAG,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC,OAAO,CAAC,0DAA0D,CAAC,CAAC;YAEvE,UAAU,CAAC,WAAW,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,EAAE,CAAC,oDAAoD,EAAE,GAAG,EAAE;YAC5D,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC,mBAAmB,EAAE,EAAE;gBACzD,OAAO,EAAE,aAAa,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,CAAC;aACnD,CAAC,CAAC;YAEH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;YACrC,MAAM,CAAC,OAAO,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;YAErE,MAAM,CAAC,GAAG,EAAE;gBACV,UAAU,CAAC,GAAG,EAAE,CAAC,mBAAmB,EAAE,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC,OAAO,CACR,+DAA+D,CAChE,CAAC;YAEF,UAAU,CAAC,WAAW,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,yBAAyB,EAAE,GAAG,EAAE;QACvC,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;YAErE,MAAM,CAAC,GAAG,EAAE;gBACV,UAAU,CAAC,GAAG,EAAE,CAAC,uBAAuB,EAAE,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC,OAAO,CACR,mEAAmE,CACpE,CAAC;YAEF,UAAU,CAAC,WAAW,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { renderHook } from \"@testing-library/react\";\nimport React from \"react\";\nimport {\n  TamboClientProvider,\n  TamboClientProviderProps,\n  useIsTamboTokenUpdating,\n  useTamboClient,\n  useTamboQueryClient,\n} from \"./tambo-client-provider\";\n\n// Mock the session token hook to control token fetching state\njest.mock(\"./hooks/use-tambo-session-token\", () => ({\n  useTamboSessionToken: jest.fn(),\n}));\n\nimport { useTamboSessionToken } from \"./hooks/use-tambo-session-token\";\n\n// Add fetch polyfill for jsdom environment (TamboAI SDK requires it)\nconst mockFetch = jest.fn();\nlet previousFetch: typeof fetch;\n\nbeforeEach(() => {\n  mockFetch.mockReset();\n  previousFetch = global.fetch;\n  global.fetch = mockFetch as unknown as typeof fetch;\n});\n\nafterEach(() => {\n  global.fetch = previousFetch;\n});\n\ndescribe(\"TamboClientProvider\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n\n    // Default mock: not fetching\n    jest.mocked(useTamboSessionToken).mockReturnValue({\n      isFetching: false,\n      data: undefined,\n      error: null,\n      isLoading: false,\n      isError: false,\n      isSuccess: false,\n      status: \"pending\",\n      fetchStatus: \"idle\",\n    } as any);\n  });\n\n  const createWrapper = (props: TamboClientProviderProps) => {\n    const Wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboClientProvider {...props}>{children}</TamboClientProvider>\n    );\n    Wrapper.displayName = \"TestWrapper\";\n    return Wrapper;\n  };\n\n  describe(\"Client Configuration\", () => {\n    it(\"should create client accessible via useTamboClient hook\", () => {\n      const { result } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({ apiKey: \"test-api-key\" }),\n      });\n\n      // Client should be a TamboAI instance with expected shape\n      expect(result.current).toBeDefined();\n      expect(result.current.beta).toBeDefined();\n    });\n\n    it(\"should provide the same client instance on re-renders\", () => {\n      const { result, rerender } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({ apiKey: \"test-api-key\" }),\n      });\n\n      const firstClient = result.current;\n      rerender();\n      const secondClient = result.current;\n\n      expect(firstClient).toBe(secondClient);\n    });\n\n    it(\"should configure client with provided tamboUrl\", () => {\n      const { result } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({\n          apiKey: \"test-api-key\",\n          tamboUrl: \"https://custom.tambo.api\",\n        }),\n      });\n\n      expect(result.current.baseURL).toBe(\"https://custom.tambo.api\");\n    });\n\n    it(\"should configure client with provided environment\", async () => {\n      const { result } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({\n          apiKey: \"test-api-key\",\n          environment: \"staging\",\n        }),\n      });\n\n      const { url } = await result.current.buildRequest({\n        method: \"get\",\n        path: \"/test-endpoint\",\n      });\n\n      expect(url).toBe(\"https://hydra-api-dev.up.railway.app/test-endpoint\");\n    });\n\n    it(\"should throw if both tamboUrl and environment are provided\", () => {\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      expect(() => {\n        renderHook(() => useTamboClient(), {\n          wrapper: createWrapper({\n            apiKey: \"test-api-key\",\n            tamboUrl: \"https://custom.tambo.api\",\n            environment: \"staging\",\n          }),\n        });\n      }).toThrow(\n        \"Ambiguous URL; The `baseURL` option (or TAMBO_AI_BASE_URL env var) and the `environment` option are given. If you want to use the environment you must pass baseURL: null\",\n      );\n\n      consoleSpy.mockRestore();\n    });\n\n    it(\"should include additional headers in client configuration\", async () => {\n      const { result } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({\n          apiKey: \"test-api-key\",\n          additionalHeaders: {\n            \"X-Custom-Header\": \"custom-value\",\n            \"X-Another-Header\": \"another-value\",\n          },\n        }),\n      });\n\n      const { req } = await result.current.buildRequest({\n        method: \"get\",\n        path: \"/test-endpoint\",\n      });\n\n      expect(req.headers.get(\"X-Tambo-React-Version\")).toBeDefined();\n      expect(req.headers.get(\"X-Tambo-React-Version\")).toMatch(/\\d+\\.\\d+\\.\\d+/); // version format\n      expect(req.headers.get(\"X-Custom-Header\")).toBe(\"custom-value\");\n      expect(req.headers.get(\"X-Another-Header\")).toBe(\"another-value\");\n    });\n  });\n\n  describe(\"Token State\", () => {\n    it(\"should expose isUpdatingToken=true when session token is fetching\", () => {\n      jest.mocked(useTamboSessionToken).mockReturnValue({\n        isFetching: true,\n      } as any);\n\n      const { result } = renderHook(() => useIsTamboTokenUpdating(), {\n        wrapper: createWrapper({\n          apiKey: \"test-api-key\",\n          userToken: \"oauth-token\",\n        }),\n      });\n\n      expect(result.current).toBe(true);\n    });\n\n    it(\"should expose isUpdatingToken=false when not fetching\", () => {\n      jest.mocked(useTamboSessionToken).mockReturnValue({\n        isFetching: false,\n      } as any);\n\n      const { result } = renderHook(() => useIsTamboTokenUpdating(), {\n        wrapper: createWrapper({ apiKey: \"test-api-key\" }),\n      });\n\n      expect(result.current).toBe(false);\n    });\n\n    it(\"should call useTamboSessionToken with userToken when provided\", () => {\n      renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({\n          apiKey: \"test-api-key\",\n          userToken: \"my-oauth-token\",\n        }),\n      });\n\n      expect(useTamboSessionToken).toHaveBeenCalledWith(\n        expect.anything(), // client\n        expect.anything(), // queryClient\n        \"my-oauth-token\",\n      );\n    });\n  });\n});\n\ndescribe(\"Hook Contracts\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n\n    jest.mocked(useTamboSessionToken).mockReturnValue({\n      isFetching: false,\n    } as any);\n  });\n\n  const createWrapper = (props: { apiKey: string }) => {\n    const Wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboClientProvider {...props}>{children}</TamboClientProvider>\n    );\n    Wrapper.displayName = \"TestWrapper\";\n    return Wrapper;\n  };\n\n  describe(\"useTamboClient\", () => {\n    it(\"should return client instance inside provider\", () => {\n      const { result } = renderHook(() => useTamboClient(), {\n        wrapper: createWrapper({ apiKey: \"test-api-key\" }),\n      });\n\n      expect(result.current).toBeDefined();\n      expect(result.current.beta).toBeDefined();\n    });\n\n    it(\"should throw descriptive error outside provider\", () => {\n      // Suppress console.error for this test\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      expect(() => {\n        renderHook(() => useTamboClient());\n      }).toThrow(\"useTamboClient must be used within a TamboClientProvider\");\n\n      consoleSpy.mockRestore();\n    });\n  });\n\n  describe(\"useTamboQueryClient\", () => {\n    it(\"should return QueryClient instance inside provider\", () => {\n      const { result } = renderHook(() => useTamboQueryClient(), {\n        wrapper: createWrapper({ apiKey: \"test-api-key\" }),\n      });\n\n      expect(result.current).toBeDefined();\n      expect(typeof result.current.getQueryCache).toBe(\"function\");\n    });\n\n    it(\"should throw descriptive error outside provider\", () => {\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      expect(() => {\n        renderHook(() => useTamboQueryClient());\n      }).toThrow(\n        \"useTamboQueryClient must be used within a TamboClientProvider\",\n      );\n\n      consoleSpy.mockRestore();\n    });\n  });\n\n  describe(\"useIsTamboTokenUpdating\", () => {\n    it(\"should throw descriptive error outside provider\", () => {\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      expect(() => {\n        renderHook(() => useIsTamboTokenUpdating());\n      }).toThrow(\n        \"useIsTamboTokenUpdating must be used within a TamboClientProvider\",\n      );\n\n      consoleSpy.mockRestore();\n    });\n  });\n});\n"]}