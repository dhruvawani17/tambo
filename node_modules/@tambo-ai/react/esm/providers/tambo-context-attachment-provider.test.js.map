{"version":3,"file":"tambo-context-attachment-provider.test.js","sourceRoot":"","sources":["../../src/providers/tambo-context-attachment-provider.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { act, renderHook, waitFor } from \"@testing-library/react\";\nimport React from \"react\";\nimport {\n  TamboContextAttachmentProvider,\n  useTamboContextAttachment,\n} from \"./tambo-context-attachment-provider\";\nimport { useTamboContextHelpers } from \"./tambo-context-helpers-provider\";\n\n// Mock the context helpers provider\njest.mock(\"./tambo-context-helpers-provider\");\n\nconst mockAddContextHelper = jest.fn();\nconst mockRemoveContextHelper = jest.fn();\n\nconst CONTEXT_ATTACHMENTS_HELPER_KEY = \"contextAttachments\";\n\nbeforeEach(() => {\n  jest.clearAllMocks();\n  (useTamboContextHelpers as jest.Mock).mockReturnValue({\n    addContextHelper: mockAddContextHelper,\n    removeContextHelper: mockRemoveContextHelper,\n  });\n});\n\n/**\n * Test suite for TamboContextAttachmentProvider\n *\n * Tests the context attachment feature which allows:\n * - Adding context attachments that will be sent with the next message\n * - Automatic registration/deregistration of context helpers\n */\ndescribe(\"TamboContextAttachmentProvider\", () => {\n  /**\n   * Base wrapper with TamboContextAttachmentProvider\n   * @returns A React component that wraps children with the provider\n   */\n  const createWrapper = () => {\n    const Wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboContextAttachmentProvider>\n        {children}\n      </TamboContextAttachmentProvider>\n    );\n    Wrapper.displayName = \"TestWrapper\";\n    return Wrapper;\n  };\n\n  describe(\"Hook Access\", () => {\n    /**\n     * Hook should provide all expected API functions when used within provider\n     */\n    it(\"should provide context attachment API functions\", () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      expect(result.current).toHaveProperty(\"attachments\");\n      expect(result.current).toHaveProperty(\"addContextAttachment\");\n      expect(result.current).toHaveProperty(\"removeContextAttachment\");\n      expect(result.current).toHaveProperty(\"clearContextAttachments\");\n    });\n\n    /**\n     * Hook should throw error when used outside of provider\n     */\n    it(\"should throw error when used outside provider\", () => {\n      // Suppress console.error for this test\n      const consoleErrorSpy = jest\n        .spyOn(console, \"error\")\n        .mockImplementation(() => {});\n\n      expect(() => {\n        renderHook(() => useTamboContextAttachment());\n      }).toThrow(\n        \"useTamboContextAttachment must be used within a TamboContextAttachmentProvider\",\n      );\n\n      consoleErrorSpy.mockRestore();\n    });\n  });\n\n  describe(\"Adding Context Attachments\", () => {\n    /**\n     * Should add a context attachment and register/update the merged context helper\n     */\n    it(\"should add a context attachment\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      let attachment: ReturnType<typeof result.current.addContextAttachment>;\n      act(() => {\n        attachment = result.current.addContextAttachment({\n          context: \"selectedFile\",\n          displayName: \"Button.tsx\",\n          type: \"file\",\n        });\n      });\n\n      expect(result.current.attachments).toHaveLength(1);\n      expect(result.current.attachments[0]).toMatchObject({\n        displayName: \"Button.tsx\",\n        context: \"selectedFile\",\n        type: \"file\",\n      });\n      expect(result.current.attachments[0].id).toBeDefined();\n      expect(attachment!.id).toBe(result.current.attachments[0].id);\n\n      // Wait for useEffect to run and register the merged helper with the attachment\n      await waitFor(() => {\n        const lastCall = mockAddContextHelper.mock.calls\n          .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n          .pop();\n        if (lastCall) {\n          const helperFn = lastCall[1];\n          const helperResult = helperFn();\n          expect(helperResult).not.toBeNull();\n          expect(helperResult).toHaveLength(1);\n        } else {\n          throw new Error(\"Helper not registered\");\n        }\n      });\n\n      // Verify the helper function returns the merged attachments array\n      const helperFn = mockAddContextHelper.mock.calls\n        .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n        .pop()?.[1];\n      expect(helperFn).toBeDefined();\n      const helperResult = helperFn!();\n      expect(helperResult).toEqual([\n        {\n          id: attachment!.id,\n          displayName: \"Button.tsx\",\n          context: \"selectedFile\",\n          type: \"file\",\n        },\n      ]);\n    });\n\n    /**\n     * Should add a context attachment without displayName\n     */\n    it(\"should add a context attachment without displayName\", () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      let attachment: ReturnType<typeof result.current.addContextAttachment>;\n      act(() => {\n        attachment = result.current.addContextAttachment({\n          context: \"selectedFile\",\n        });\n      });\n\n      expect(result.current.attachments).toHaveLength(1);\n      expect(result.current.attachments[0]).toMatchObject({\n        context: \"selectedFile\",\n      });\n      expect(result.current.attachments[0].displayName).toBeUndefined();\n      expect(attachment!.id).toBe(result.current.attachments[0].id);\n    });\n\n    /**\n     * Should add multiple different context attachments and update the merged helper\n     */\n    it(\"should add multiple context attachments\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      act(() => {\n        result.current.addContextAttachment({\n          context: \"file1\",\n          displayName: \"Button.tsx\",\n          type: \"file\",\n        });\n        result.current.addContextAttachment({\n          context: \"file2\",\n          displayName: \"Card.tsx\",\n          type: \"file\",\n        });\n      });\n\n      expect(result.current.attachments).toHaveLength(2);\n      expect(result.current.attachments[0].displayName).toBe(\"Button.tsx\");\n      expect(result.current.attachments[1].displayName).toBe(\"Card.tsx\");\n\n      // Wait for useEffect to run and update the merged helper\n      await waitFor(() => {\n        // The helper should be called/updated for each attachment change\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      // Verify the helper function returns all attachments\n      const helperFn = mockAddContextHelper.mock.calls\n        .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n        .pop()?.[1];\n      expect(helperFn).toBeDefined();\n      const helperResult = helperFn!();\n      expect(helperResult).toHaveLength(2);\n      expect(helperResult[0].displayName).toBe(\"Button.tsx\");\n      expect(helperResult[1].displayName).toBe(\"Card.tsx\");\n    });\n\n    /**\n     * Should allow multiple attachments with the same context value\n     */\n    it(\"should allow multiple attachments with same context value\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      act(() => {\n        result.current.addContextAttachment({\n          context: \"selectedFile\",\n          displayName: \"Button.tsx\",\n          type: \"file\",\n        });\n        result.current.addContextAttachment({\n          context: \"selectedFile\",\n          displayName: \"Card.tsx\",\n          type: \"file\",\n        });\n      });\n\n      expect(result.current.attachments).toHaveLength(2);\n\n      // Wait for useEffect to update the merged helper\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      // Verify both attachments are included in the merged result\n      const helperFn = mockAddContextHelper.mock.calls\n        .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n        .pop()?.[1];\n      expect(helperFn).toBeDefined();\n      const helperResult = helperFn!();\n      expect(helperResult).toHaveLength(2);\n    });\n\n    /**\n     * Should support optional type property\n     */\n    it(\"should support optional type property\", () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      act(() => {\n        result.current.addContextAttachment({\n          context: \"file1\",\n          displayName: \"Button.tsx\",\n          type: \"file\",\n        });\n        result.current.addContextAttachment({\n          context: \"page1\",\n          displayName: \"Dashboard\",\n          type: \"page\",\n        });\n      });\n\n      expect(result.current.attachments[0].type).toBe(\"file\");\n      expect(result.current.attachments[1].type).toBe(\"page\");\n    });\n  });\n\n  describe(\"Removing Context Attachments\", () => {\n    /**\n     * Should remove a specific context attachment by ID and update the merged helper\n     */\n    it(\"should remove context attachment by ID\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      let attachmentId = \"\";\n      act(() => {\n        const attachment = result.current.addContextAttachment({\n          context: \"selectedFile\",\n          displayName: \"Button.tsx\",\n        });\n        attachmentId = attachment.id;\n      });\n\n      expect(result.current.attachments).toHaveLength(1);\n\n      // Wait for initial helper registration\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      act(() => {\n        result.current.removeContextAttachment(attachmentId);\n      });\n\n      expect(result.current.attachments).toHaveLength(0);\n\n      // Wait for useEffect to update the helper (should return null when empty)\n      await waitFor(() => {\n        const lastCall = mockAddContextHelper.mock.calls\n          .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n          .pop();\n        if (lastCall) {\n          const helperFn = lastCall[1];\n          expect(helperFn()).toBeNull();\n        }\n      });\n    });\n\n    /**\n     * Should only remove the specified attachment when multiple exist\n     */\n    it(\"should only remove specified attachment\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      let firstId = \"\";\n      act(() => {\n        const first = result.current.addContextAttachment({\n          context: \"file1\",\n          displayName: \"First.tsx\",\n        });\n        result.current.addContextAttachment({\n          context: \"file2\",\n          displayName: \"Second.tsx\",\n        });\n        firstId = first.id;\n      });\n\n      expect(result.current.attachments).toHaveLength(2);\n\n      // Wait for initial helper registration\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      act(() => {\n        result.current.removeContextAttachment(firstId);\n      });\n\n      expect(result.current.attachments).toHaveLength(1);\n      expect(result.current.attachments[0].displayName).toBe(\"Second.tsx\");\n\n      // Wait for useEffect to update the helper with remaining attachment\n      await waitFor(() => {\n        const lastCall = mockAddContextHelper.mock.calls\n          .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n          .pop();\n        if (lastCall) {\n          const helperFn = lastCall[1];\n          const helperResult = helperFn();\n          expect(helperResult).toHaveLength(1);\n          expect(helperResult[0].displayName).toBe(\"Second.tsx\");\n        }\n      });\n    });\n\n    /**\n     * Should handle removing non-existent attachment gracefully\n     */\n    it(\"should handle removing non-existent attachment gracefully\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      // Wait for initial helper registration (useEffect runs on mount)\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      expect(() => {\n        act(() => {\n          result.current.removeContextAttachment(\"non-existent-id\");\n        });\n      }).not.toThrow();\n\n      // The helper is registered on mount, so removeContextHelper will be called\n      // when the component unmounts or when attachments change, but not for\n      // removing a non-existent attachment since attachments didn't change\n      // However, the cleanup function from the initial useEffect registration\n      // may be called. Let's just verify the attachment list is still empty.\n      expect(result.current.attachments).toHaveLength(0);\n    });\n  });\n\n  describe(\"Clearing All Context Attachments\", () => {\n    /**\n     * Should clear all context attachments and update the merged helper to return null\n     */\n    it(\"should clear all context attachments\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      act(() => {\n        result.current.addContextAttachment({\n          context: \"file1\",\n          displayName: \"First.tsx\",\n        });\n        result.current.addContextAttachment({\n          context: \"file2\",\n          displayName: \"Second.tsx\",\n        });\n        result.current.addContextAttachment({\n          context: \"file3\",\n          displayName: \"Third.tsx\",\n        });\n      });\n\n      expect(result.current.attachments).toHaveLength(3);\n\n      // Wait for initial helper registration\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      act(() => {\n        result.current.clearContextAttachments();\n      });\n\n      expect(result.current.attachments).toHaveLength(0);\n\n      // Wait for useEffect to update the helper (should return null when empty)\n      await waitFor(() => {\n        const lastCall = mockAddContextHelper.mock.calls\n          .filter((call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY)\n          .pop();\n        if (lastCall) {\n          const helperFn = lastCall[1];\n          expect(helperFn()).toBeNull();\n        }\n      });\n    });\n\n    /**\n     * Should handle clearing when no attachments exist\n     */\n    it(\"should handle clearing when no attachments exist\", async () => {\n      const { result } = renderHook(() => useTamboContextAttachment(), {\n        wrapper: createWrapper(),\n      });\n\n      expect(() => {\n        act(() => {\n          result.current.clearContextAttachments();\n        });\n      }).not.toThrow();\n\n      expect(result.current.attachments).toHaveLength(0);\n\n      // Wait for useEffect to run - helper should be registered and return null\n      await waitFor(() => {\n        expect(mockAddContextHelper).toHaveBeenCalledWith(\n          CONTEXT_ATTACHMENTS_HELPER_KEY,\n          expect.any(Function),\n        );\n      });\n\n      const helperFn = mockAddContextHelper.mock.calls.find(\n        (call) => call[0] === CONTEXT_ATTACHMENTS_HELPER_KEY,\n      )?.[1];\n      expect(helperFn).toBeDefined();\n      expect(helperFn!()).toBeNull();\n    });\n  });\n});\n"]}