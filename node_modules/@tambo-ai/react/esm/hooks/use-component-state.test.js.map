{"version":3,"file":"use-component-state.test.js","sourceRoot":"","sources":["../../src/hooks/use-component-state.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { act, renderHook } from \"@testing-library/react\";\nimport React from \"react\";\nimport { TamboThreadMessage } from \"../model/generate-component-response\";\nimport { useTamboClient } from \"../providers/tambo-client-provider\";\nimport { useTamboInteractable } from \"../providers/tambo-interactable-provider\";\nimport { useTamboThread } from \"../providers/tambo-thread-provider\";\nimport { PartialTamboAI } from \"../testing/types\";\nimport { useTamboComponentState } from \"./use-component-state\";\nimport {\n  TamboMessageContext,\n  useTamboCurrentMessage,\n} from \"./use-current-message\";\n\n// Mock the required providers\njest.mock(\"../providers/tambo-client-provider\", () => ({\n  useTamboClient: jest.fn(),\n}));\n\njest.mock(\"../providers/tambo-thread-provider\", () => ({\n  useTamboThread: jest.fn(),\n}));\n\njest.mock(\"./use-current-message\", () => ({\n  useTamboCurrentMessage: jest.fn(),\n  TamboMessageContext: React.createContext<TamboThreadMessage | null>(null),\n}));\n\njest.mock(\"../providers/tambo-interactable-provider\", () => ({\n  useTamboInteractable: jest.fn(),\n}));\n\n// Create a mock debounced function with flush method\nconst createMockDebouncedFunction = (fn: any) => {\n  const debouncedFn = jest.fn((...args: any[]) => fn(...args)) as jest.Mock & {\n    flush: jest.Mock;\n    cancel: jest.Mock;\n    isPending: () => boolean;\n  };\n  debouncedFn.flush = jest.fn();\n  debouncedFn.cancel = jest.fn();\n  debouncedFn.isPending = jest.fn(() => false);\n  return debouncedFn;\n};\n\n// Mock use-debounce\njest.mock(\"use-debounce\", () => ({\n  useDebouncedCallback: jest.fn(),\n}));\n\n// Import the mocked useDebouncedCallback\nimport { useDebouncedCallback } from \"use-debounce\";\n\ndescribe(\"useTamboComponentState\", () => {\n  // Helper function to create mock TamboThreadMessage\n  const createMockMessage = (\n    overrides: Partial<TamboThreadMessage> = {},\n  ): TamboThreadMessage => ({\n    id: \"test-message-id\",\n    threadId: \"test-thread-id\",\n    componentState: {},\n    content: [{ type: \"text\", text: \"Test message\" }],\n    createdAt: new Date().toISOString(),\n    role: \"assistant\",\n    ...overrides,\n  });\n\n  const mockUpdateThreadMessage = jest.fn();\n  const mockUpdateComponentState = jest.fn();\n  const mockSetInteractableState = jest.fn();\n  const mockGetInteractableComponentState = jest.fn();\n\n  // Track context values for mocking\n  let mockMessage: TamboThreadMessage | null = null;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n\n    // Reset context values\n    mockMessage = createMockMessage();\n\n    // Mock useContext to return appropriate values based on context\n    const originalUseContext = React.useContext;\n    jest.spyOn(React, \"useContext\").mockImplementation((context) => {\n      if (context === TamboMessageContext) {\n        // Return the message from useTamboCurrentMessage mock if available\n        try {\n          const currentMessageMock = jest.mocked(useTamboCurrentMessage);\n          const mockImpl = currentMessageMock.getMockImplementation();\n          if (mockImpl) {\n            return mockImpl();\n          }\n        } catch {\n          // Fallback to mockMessage\n        }\n        return mockMessage;\n      }\n      // For other contexts, use the original implementation\n      return originalUseContext(context);\n    });\n\n    // Setup default mock for useDebouncedCallback\n    jest\n      .mocked(useDebouncedCallback)\n      .mockImplementation((fn) => createMockDebouncedFunction(fn));\n\n    // Setup default mocks\n    jest.mocked(useTamboClient).mockReturnValue({\n      beta: {\n        threads: {\n          messages: {\n            updateComponentState: mockUpdateComponentState,\n          },\n        },\n      },\n    } satisfies PartialTamboAI as any);\n\n    jest.mocked(useTamboThread).mockReturnValue({\n      updateThreadMessage: mockUpdateThreadMessage,\n    } as any);\n\n    jest.mocked(useTamboCurrentMessage).mockReturnValue(createMockMessage());\n\n    jest.mocked(useTamboInteractable).mockReturnValue({\n      setInteractableState: mockSetInteractableState,\n      getInteractableComponentState: mockGetInteractableComponentState,\n    } as any);\n  });\n\n  afterEach(() => {\n    jest.restoreAllMocks();\n  });\n\n  describe(\"Initial State Management\", () => {\n    it(\"should initialize with initialValue when no componentState exists\", () => {\n      const initialValue = \"test-initial\";\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(createMockMessage({ componentState: {} }));\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", initialValue),\n      );\n\n      expect(result.current[0]).toBe(initialValue);\n    });\n\n    it(\"should use existing componentState value over initialValue\", () => {\n      const initialValue = \"initial\";\n      const existingValue = \"existing\";\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(\n        createMockMessage({\n          componentState: { testKey: existingValue },\n        }),\n      );\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", initialValue),\n      );\n\n      expect(result.current[0]).toBe(existingValue);\n    });\n\n    it(\"should handle undefined initialValue gracefully\", () => {\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(createMockMessage({ componentState: {} }));\n\n      const { result } = renderHook(() => useTamboComponentState(\"testKey\"));\n\n      expect(result.current[0]).toBeUndefined();\n    });\n\n    it(\"should handle different data types correctly\", () => {\n      const testCases = [\n        { value: \"string\" },\n        { value: 42 },\n        { value: true },\n        { value: { name: \"test\" } },\n        { value: [1, 2, 3] },\n      ];\n\n      testCases.forEach(({ value }) => {\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            componentState: { testKey: value },\n          }),\n        );\n\n        const { result } = renderHook(() =>\n          useTamboComponentState(\"testKey\", value),\n        );\n\n        expect(result.current[0]).toEqual(value);\n      });\n    });\n  });\n\n  describe(\"State Updates\", () => {\n    it(\"should update local state immediately when setValue is called\", () => {\n      const initialValue = \"initial\";\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(\n          createMockMessage({ componentState: { testKey: initialValue } }),\n        );\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", initialValue),\n      );\n\n      const newValue = \"updated\";\n      act(() => {\n        result.current[1](newValue);\n      });\n\n      expect(result.current[0]).toBe(newValue);\n    });\n\n    it(\"should trigger local thread message update when setValue is called\", () => {\n      const message = createMockMessage({\n        componentState: { testKey: \"initial\" },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      const newValue = \"updated\";\n      act(() => {\n        result.current[1](newValue);\n      });\n\n      expect(mockUpdateThreadMessage).toHaveBeenCalledWith(\n        message.id,\n        {\n          threadId: message.threadId,\n          componentState: {\n            testKey: newValue,\n          },\n        },\n        false,\n      );\n    });\n\n    it(\"should trigger debounced remote API call when setValue is called\", () => {\n      const message = createMockMessage({\n        componentState: { testKey: \"initial\" },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      const newValue = \"updated\";\n      act(() => {\n        result.current[1](newValue);\n      });\n\n      // The debounced function should be called\n      expect(mockUpdateComponentState).toHaveBeenCalledWith(message.id, {\n        id: message.threadId,\n        state: { testKey: newValue },\n      });\n    });\n\n    it(\"should work with complex objects and arrays\", () => {\n      const initialValue = { name: \"test\", items: [1, 2, 3] };\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(\n          createMockMessage({ componentState: { testKey: initialValue } }),\n        );\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", initialValue),\n      );\n\n      const newValue = { name: \"updated\", items: [4, 5, 6] };\n      act(() => {\n        result.current[1](newValue);\n      });\n\n      expect(result.current[0]).toEqual(newValue);\n      expect(mockUpdateThreadMessage).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({\n          componentState: {\n            testKey: newValue,\n          },\n        }),\n        false,\n      );\n    });\n  });\n\n  describe(\"Debouncing Behavior\", () => {\n    it(\"should use default debounce time of 500ms\", () => {\n      renderHook(() => useTamboComponentState(\"testKey\", \"initial\"));\n\n      expect(useDebouncedCallback).toHaveBeenCalledWith(\n        expect.any(Function),\n        500,\n      );\n    });\n\n    it(\"should use custom debounce time when provided\", () => {\n      const customDebounceTime = 1000;\n\n      renderHook(() =>\n        useTamboComponentState(\n          \"testKey\",\n          \"initial\",\n          undefined,\n          customDebounceTime,\n        ),\n      );\n\n      expect(useDebouncedCallback).toHaveBeenCalledWith(\n        expect.any(Function),\n        customDebounceTime,\n      );\n    });\n\n    it(\"should flush debounced callback on unmount\", () => {\n      const mockFlush = jest.fn();\n      const mockDebouncedFn = createMockDebouncedFunction(jest.fn());\n      mockDebouncedFn.flush = mockFlush;\n\n      // Mock the debounced callback to return our specific mock\n      jest.mocked(useDebouncedCallback).mockReturnValue(mockDebouncedFn);\n\n      const { unmount } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      unmount();\n\n      expect(mockFlush).toHaveBeenCalled();\n    });\n  });\n\n  describe(\"Multi-Hook Scenarios\", () => {\n    it(\"should handle multiple hooks with different keyNames independently\", () => {\n      const message = createMockMessage({\n        componentState: {\n          key1: \"value1\",\n          key2: \"value2\",\n        },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      const { result: result1 } = renderHook(() =>\n        useTamboComponentState(\"key1\", \"default1\"),\n      );\n      const { result: result2 } = renderHook(() =>\n        useTamboComponentState(\"key2\", \"default2\"),\n      );\n\n      expect(result1.current[0]).toBe(\"value1\");\n      expect(result2.current[0]).toBe(\"value2\");\n\n      // Update first hook\n      act(() => {\n        result1.current[1](\"updated1\");\n      });\n\n      expect(result1.current[0]).toBe(\"updated1\");\n      expect(result2.current[0]).toBe(\"value2\"); // Should remain unchanged\n    });\n\n    it(\"should preserve existing componentState when updating another key\", () => {\n      const message = createMockMessage({\n        componentState: {\n          existingKey: \"existing\",\n          testKey: \"initial\",\n        },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      act(() => {\n        result.current[1](\"updated\");\n      });\n\n      expect(mockUpdateThreadMessage).toHaveBeenCalledWith(\n        message.id,\n        {\n          threadId: message.threadId,\n          componentState: {\n            existingKey: \"existing\", // Should preserve existing keys\n            testKey: \"updated\",\n          },\n        },\n        false,\n      );\n    });\n  });\n\n  describe(\"SetFromProp Feature\", () => {\n    it(\"should set value from prop when hasSetFromMessage is false\", () => {\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(createMockMessage({ componentState: {} }));\n\n      const propValue = \"from-prop\";\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\", propValue),\n      );\n\n      // Initially, hasSetFromMessage should be false, so prop value should be used\n      expect(result.current[0]).toBe(propValue);\n    });\n\n    it(\"should ignore setFromProp when initialized from message state\", async () => {\n      const existingValue = \"existing\";\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(\n        createMockMessage({\n          componentState: { testKey: existingValue },\n        }),\n      );\n\n      const propValue = \"from-prop\";\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\", propValue),\n      );\n\n      // Should use existing value from message, not prop value\n      await act(async () => {\n        await new Promise((resolve) => setTimeout(resolve, 0));\n      });\n\n      expect(result.current[0]).toBe(existingValue);\n    });\n\n    it(\"should update state from setFromProp changes when no message state exists\", () => {\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(createMockMessage({ componentState: {} }));\n\n      const { result, rerender } = renderHook(\n        ({ propValue }) =>\n          useTamboComponentState(\"testKey\", \"initial\", propValue),\n        { initialProps: { propValue: \"prop1\" } },\n      );\n\n      expect(result.current[0]).toBe(\"prop1\");\n\n      // Change prop value\n      rerender({ propValue: \"prop2\" });\n\n      // Since hasSetFromMessage is still false (no message state),\n      // it should update to new prop value\n      expect(result.current[0]).toBe(\"prop2\");\n    });\n\n    it(\"should handle undefined setFromProp gracefully\", () => {\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(createMockMessage({ componentState: {} }));\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\", undefined),\n      );\n\n      expect(result.current[0]).toBe(\"initial\");\n    });\n  });\n\n  describe(\"Interactable State Sync\", () => {\n    it(\"should sync local state when interactable state changes externally\", () => {\n      // Setup: Component is in interactable context with an ID\n      const message = createMockMessage({\n        componentState: {},\n        interactableMetadata: {\n          id: \"test-interactable-id\",\n          componentName: \"TestComponent\",\n          description: \"Test\",\n        },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      // Start with initial state\n      mockGetInteractableComponentState.mockReturnValue({ testKey: \"initial\" });\n\n      const { result, rerender } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      expect(result.current[0]).toBe(\"initial\");\n\n      // Simulate external state update (e.g., from Tambo tool call)\n      mockGetInteractableComponentState.mockReturnValue({\n        testKey: \"updated-by-tambo\",\n      });\n\n      // Trigger rerender to pick up new interactable state\n      rerender();\n\n      // Local state should sync with the external update\n      expect(result.current[0]).toBe(\"updated-by-tambo\");\n    });\n\n    it(\"should not sync when not in interactable context\", () => {\n      // Setup: Component is NOT in interactable context (no interactableMetadata.id)\n      const message = createMockMessage({\n        componentState: { testKey: \"initial\" },\n      });\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n\n      mockGetInteractableComponentState.mockReturnValue({ testKey: \"ignored\" });\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      // Should use message state, not interactable state\n      expect(result.current[0]).toBe(\"initial\");\n    });\n  });\n\n  describe(\"Message State Sync\", () => {\n    it(\"should sync with message.componentState changes\", () => {\n      const { result, rerender } = renderHook(\n        ({ message }) => {\n          jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n          return useTamboComponentState(\"testKey\", \"initial\");\n        },\n        {\n          initialProps: {\n            message: createMockMessage({\n              componentState: { testKey: \"value1\" },\n            }),\n          },\n        },\n      );\n\n      // Change the message\n      const newMessage = createMockMessage({\n        componentState: { testKey: \"value2\" },\n      });\n\n      rerender({ message: newMessage });\n\n      // The hook should sync with the new message state\n      expect(result.current[0]).toBe(\"value2\");\n      expect(mockUpdateThreadMessage).not.toHaveBeenCalled();\n    });\n\n    it(\"should handle message without componentState gracefully\", () => {\n      jest\n        .mocked(useTamboCurrentMessage)\n        .mockReturnValue(\n          createMockMessage({ componentState: undefined as any }),\n        );\n\n      const { result } = renderHook(() =>\n        useTamboComponentState(\"testKey\", \"initial\"),\n      );\n\n      expect(result.current[0]).toBe(\"initial\");\n    });\n\n    it(\"should preserve state when message updates but componentState[keyName] unchanged\", () => {\n      const message1 = createMockMessage({\n        id: \"message1\",\n        componentState: { testKey: \"unchanged\" },\n      });\n      const message2 = createMockMessage({\n        id: \"message2\",\n        componentState: { testKey: \"unchanged\" },\n      });\n\n      const { result, rerender } = renderHook(\n        ({ message }) => {\n          jest.mocked(useTamboCurrentMessage).mockReturnValue(message);\n          return useTamboComponentState(\"testKey\", \"initial\");\n        },\n        { initialProps: { message: message1 } },\n      );\n\n      // Clear previous calls\n      mockUpdateThreadMessage.mockClear();\n\n      // Change message but keep same componentState value\n      rerender({ message: message2 });\n\n      // Should preserve the \"unchanged\" value\n      expect(result.current[0]).toBe(\"unchanged\");\n    });\n  });\n});\n"]}