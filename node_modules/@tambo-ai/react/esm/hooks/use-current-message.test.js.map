{"version":3,"file":"use-current-message.test.js","sourceRoot":"","sources":["../../src/hooks/use-current-message.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { render, renderHook, screen } from \"@testing-library/react\";\nimport React from \"react\";\nimport {\n  InteractableMetadata,\n  TamboThreadMessage,\n} from \"../model/generate-component-response\";\nimport {\n  TamboMessageProvider,\n  useTamboCurrentComponent,\n  useTamboCurrentMessage,\n} from \"./use-current-message\";\n\ndescribe(\"TamboMessageProvider\", () => {\n  const createMockMessage = (\n    overrides: Partial<TamboThreadMessage> = {},\n  ): TamboThreadMessage => ({\n    id: \"test-message-id\",\n    threadId: \"test-thread-id\",\n    componentState: {},\n    content: [{ type: \"text\", text: \"Test message\" }],\n    createdAt: new Date().toISOString(),\n    role: \"assistant\",\n    ...overrides,\n  });\n\n  it(\"should provide message context to children\", () => {\n    const message = createMockMessage();\n\n    const TestComponent = () => {\n      const currentMessage = useTamboCurrentMessage();\n      return <div>{currentMessage.id}</div>;\n    };\n\n    render(\n      <TamboMessageProvider message={message}>\n        <TestComponent />\n      </TamboMessageProvider>,\n    );\n\n    expect(screen.getByText(\"test-message-id\")).toBeInTheDocument();\n  });\n\n  it(\"should merge interactable metadata into message\", () => {\n    const message = createMockMessage();\n    const interactableMetadata: InteractableMetadata = {\n      id: \"interactable-123\",\n      componentName: \"TestComponent\",\n      description: \"Test description\",\n    };\n\n    const TestComponent = () => {\n      const currentMessage = useTamboCurrentMessage();\n      return (\n        <div>\n          <span data-testid=\"message-id\">{currentMessage.id}</span>\n          <span data-testid=\"interactable-id\">\n            {currentMessage.interactableMetadata?.id}\n          </span>\n        </div>\n      );\n    };\n\n    render(\n      <TamboMessageProvider\n        message={message}\n        interactableMetadata={interactableMetadata}\n      >\n        <TestComponent />\n      </TamboMessageProvider>,\n    );\n\n    expect(screen.getByTestId(\"message-id\")).toHaveTextContent(\n      \"test-message-id\",\n    );\n    expect(screen.getByTestId(\"interactable-id\")).toHaveTextContent(\n      \"interactable-123\",\n    );\n  });\n\n  it(\"should work without interactable metadata\", () => {\n    const message = createMockMessage();\n\n    const TestComponent = () => {\n      const currentMessage = useTamboCurrentMessage();\n      return (\n        <div>\n          <span data-testid=\"has-metadata\">\n            {currentMessage.interactableMetadata ? \"yes\" : \"no\"}\n          </span>\n        </div>\n      );\n    };\n\n    render(\n      <TamboMessageProvider message={message}>\n        <TestComponent />\n      </TamboMessageProvider>,\n    );\n\n    expect(screen.getByTestId(\"has-metadata\")).toHaveTextContent(\"no\");\n  });\n\n  it(\"should use message.id as key for re-renders\", () => {\n    const message1 = createMockMessage({ id: \"message-1\" });\n    const message2 = createMockMessage({ id: \"message-2\" });\n\n    let renderCount = 0;\n    const TestComponent = () => {\n      renderCount++;\n      const currentMessage = useTamboCurrentMessage();\n      return <div>{currentMessage.id}</div>;\n    };\n\n    const { rerender } = render(\n      <TamboMessageProvider message={message1}>\n        <TestComponent />\n      </TamboMessageProvider>,\n    );\n\n    expect(renderCount).toBe(1);\n    expect(screen.getByText(\"message-1\")).toBeInTheDocument();\n\n    // Change to new message - should force re-render due to key change\n    rerender(\n      <TamboMessageProvider message={message2}>\n        <TestComponent />\n      </TamboMessageProvider>,\n    );\n\n    expect(renderCount).toBe(2);\n    expect(screen.getByText(\"message-2\")).toBeInTheDocument();\n  });\n});\n\ndescribe(\"useTamboCurrentMessage\", () => {\n  const createMockMessage = (\n    overrides: Partial<TamboThreadMessage> = {},\n  ): TamboThreadMessage => ({\n    id: \"test-message-id\",\n    threadId: \"test-thread-id\",\n    componentState: {},\n    content: [{ type: \"text\", text: \"Test message\" }],\n    createdAt: new Date().toISOString(),\n    role: \"assistant\",\n    ...overrides,\n  });\n\n  it(\"should throw error when used outside TamboMessageProvider\", () => {\n    // Suppress console.error for this test\n    const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n    expect(() => {\n      renderHook(() => useTamboCurrentMessage());\n    }).toThrow(\n      \"useTamboCurrentMessage must be used within a TamboMessageProvider\",\n    );\n\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should return the current message\", () => {\n    const message = createMockMessage();\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider message={message}>{children}</TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentMessage(), { wrapper });\n\n    expect(result.current).toEqual(\n      expect.objectContaining({\n        id: \"test-message-id\",\n        threadId: \"test-thread-id\",\n      }),\n    );\n  });\n\n  it(\"should return message with interactable metadata when provided\", () => {\n    const message = createMockMessage();\n    const interactableMetadata: InteractableMetadata = {\n      id: \"interactable-123\",\n      componentName: \"TestComponent\",\n      description: \"Test description\",\n    };\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider\n        message={message}\n        interactableMetadata={interactableMetadata}\n      >\n        {children}\n      </TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentMessage(), { wrapper });\n\n    expect(result.current.interactableMetadata).toEqual(interactableMetadata);\n  });\n});\n\ndescribe(\"useTamboCurrentComponent\", () => {\n  const createMockMessage = (\n    overrides: Partial<TamboThreadMessage> = {},\n  ): TamboThreadMessage => ({\n    id: \"test-message-id\",\n    threadId: \"test-thread-id\",\n    componentState: {},\n    content: [{ type: \"text\", text: \"Test message\" }],\n    createdAt: new Date().toISOString(),\n    role: \"assistant\",\n    ...overrides,\n  });\n\n  it(\"should return null when used outside TamboMessageProvider\", () => {\n    const { result } = renderHook(() => useTamboCurrentComponent());\n\n    expect(result.current).toBeNull();\n  });\n\n  it(\"should return component info from message.component\", () => {\n    const message = createMockMessage({\n      component: {\n        componentName: \"WeatherCard\",\n        componentState: {},\n        message: \"\",\n        props: {\n          city: \"San Francisco\",\n          temperature: 72,\n        },\n      },\n    });\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider message={message}>{children}</TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current).toEqual({\n      componentName: \"WeatherCard\",\n      props: {\n        city: \"San Francisco\",\n        temperature: 72,\n      },\n      interactableId: undefined,\n      description: undefined,\n      threadId: \"test-thread-id\",\n    });\n  });\n\n  it(\"should return interactable metadata when provided\", () => {\n    const message = createMockMessage({\n      component: {\n        componentName: \"WeatherCard\",\n        componentState: {},\n        message: \"\",\n        props: {\n          city: \"San Francisco\",\n          temperature: 72,\n        },\n      },\n    });\n\n    const interactableMetadata: InteractableMetadata = {\n      id: \"interactable-456\",\n      componentName: \"WeatherCard\",\n      description: \"Shows current weather\",\n    };\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider\n        message={message}\n        interactableMetadata={interactableMetadata}\n      >\n        {children}\n      </TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current).toEqual({\n      componentName: \"WeatherCard\",\n      props: {\n        city: \"San Francisco\",\n        temperature: 72,\n      },\n      interactableId: \"interactable-456\",\n      description: \"Shows current weather\",\n      threadId: \"test-thread-id\",\n    });\n  });\n\n  it(\"should prioritize interactableMetadata.componentName over message.component.componentName\", () => {\n    const message = createMockMessage({\n      component: {\n        componentName: \"OldComponentName\",\n        componentState: {},\n        message: \"\",\n        props: {},\n      },\n    });\n\n    const interactableMetadata: InteractableMetadata = {\n      id: \"interactable-789\",\n      componentName: \"NewComponentName\",\n      description: \"New description\",\n    };\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider\n        message={message}\n        interactableMetadata={interactableMetadata}\n      >\n        {children}\n      </TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current?.componentName).toBe(\"NewComponentName\");\n  });\n\n  it(\"should handle message with only interactable metadata (no component)\", () => {\n    const message = createMockMessage(); // No component field\n\n    const interactableMetadata: InteractableMetadata = {\n      id: \"interactable-only\",\n      componentName: \"InteractableComponent\",\n      description: \"Interactable only\",\n    };\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider\n        message={message}\n        interactableMetadata={interactableMetadata}\n      >\n        {children}\n      </TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current).toEqual({\n      componentName: \"InteractableComponent\",\n      props: undefined,\n      interactableId: \"interactable-only\",\n      description: \"Interactable only\",\n      threadId: \"test-thread-id\",\n    });\n  });\n\n  it(\"should handle message with component but no interactable metadata\", () => {\n    const message = createMockMessage({\n      component: {\n        componentName: \"SimpleComponent\",\n        componentState: {},\n        message: \"\",\n        props: {\n          title: \"Hello\",\n        },\n      },\n    });\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider message={message}>{children}</TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current).toEqual({\n      componentName: \"SimpleComponent\",\n      props: {\n        title: \"Hello\",\n      },\n      interactableId: undefined,\n      description: undefined,\n      threadId: \"test-thread-id\",\n    });\n  });\n\n  it(\"should return undefined for all fields when message has neither component nor interactable metadata\", () => {\n    const message = createMockMessage(); // Minimal message with no component or interactable data\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => (\n      <TamboMessageProvider message={message}>{children}</TamboMessageProvider>\n    );\n\n    const { result } = renderHook(() => useTamboCurrentComponent(), {\n      wrapper,\n    });\n\n    expect(result.current).toEqual({\n      componentName: undefined,\n      props: undefined,\n      interactableId: undefined,\n      description: undefined,\n      threadId: \"test-thread-id\",\n    });\n  });\n});\n"]}