{"version":3,"file":"schema.test.js","sourceRoot":"","sources":["../../src/schema/schema.test.ts"],"names":[],"mappings":"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","sourcesContent":["import type { JSONSchema7 } from \"json-schema\";\nimport * as z3 from \"zod/v3\";\nimport * as z4 from \"zod/v4\";\nimport { TamboTool } from \"../model/component-metadata\";\nimport { looksLikeJSONSchema } from \"./json-schema\";\nimport {\n  getParametersFromToolSchema,\n  safeSchemaToJsonSchema,\n  schemaToJsonSchema,\n} from \"./schema\";\nimport { isStandardSchema } from \"./standard-schema\";\n\ndescribe(\"schema utilities\", () => {\n  describe(\"looksLikeJSONSchema\", () => {\n    it(\"returns true for a basic JSON Schema object\", () => {\n      const jsonSchema: JSONSchema7 = {\n        type: \"object\",\n        properties: {\n          name: { type: \"string\" },\n          age: { type: \"integer\" },\n        },\n        required: [\"name\"],\n      };\n\n      expect(looksLikeJSONSchema(jsonSchema)).toBe(true);\n    });\n\n    it(\"returns true for a union type JSON Schema\", () => {\n      const jsonSchema: JSONSchema7 = {\n        type: [\"string\", \"null\"],\n      };\n\n      expect(looksLikeJSONSchema(jsonSchema)).toBe(true);\n    });\n\n    it(\"returns false for Standard Schema validators\", () => {\n      const zodSchema = z4.object({\n        name: z4.string(),\n      });\n\n      expect(isStandardSchema(zodSchema)).toBe(true);\n      expect(looksLikeJSONSchema(zodSchema)).toBe(false);\n    });\n\n    it(\"returns false for arbitrary objects that do not resemble JSON Schema\", () => {\n      const notSchema = {\n        type: \"foo\",\n        other: \"bar\",\n      };\n\n      expect(looksLikeJSONSchema(notSchema)).toBe(false);\n    });\n  });\n\n  describe(\"getParametersFromToolSchema\", () => {\n    describe(\"inputSchema interface (object schemas)\", () => {\n      it(\"extracts parameters from Zod 4 object schema properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            query: z4.string().describe(\"Search query\"),\n            limit: z4.number().describe(\"Max results\"),\n            enabled: z4.boolean().optional().describe(\"Whether enabled\"),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(3);\n\n        const queryParam = params.find((p) => p.name === \"query\");\n        expect(queryParam).toBeDefined();\n        expect(queryParam?.type).toBe(\"string\");\n        expect(queryParam?.description).toBe(\"Search query\");\n        expect(queryParam?.isRequired).toBe(true);\n\n        const limitParam = params.find((p) => p.name === \"limit\");\n        expect(limitParam).toBeDefined();\n        expect(limitParam?.type).toBe(\"number\");\n        expect(limitParam?.description).toBe(\"Max results\");\n        expect(limitParam?.isRequired).toBe(true);\n\n        const enabledParam = params.find((p) => p.name === \"enabled\");\n        expect(enabledParam).toBeDefined();\n        expect(enabledParam?.type).toBe(\"boolean\");\n        // Optional fields are not required\n        expect(enabledParam?.isRequired).toBe(false);\n      });\n\n      it(\"extracts parameters from Zod 3 object schema properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z3.object({\n            name: z3.string().describe(\"User name\"),\n            age: z3.number().optional(),\n          }),\n          outputSchema: z3.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n\n        const nameParam = params.find((p) => p.name === \"name\");\n        expect(nameParam).toBeDefined();\n        expect(nameParam?.type).toBe(\"string\");\n        expect(nameParam?.isRequired).toBe(true);\n\n        const ageParam = params.find((p) => p.name === \"age\");\n        expect(ageParam).toBeDefined();\n        expect(ageParam?.type).toBe(\"number\");\n        expect(ageParam?.isRequired).toBe(false);\n      });\n\n      it(\"extracts parameters from JSON Schema object properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: {\n            type: \"object\",\n            properties: {\n              id: { type: \"string\", description: \"Item ID\" },\n              count: { type: \"number\", description: \"Item count\" },\n              active: { type: \"boolean\" },\n            },\n            required: [\"id\"],\n          } as JSONSchema7,\n          outputSchema: {},\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(3);\n\n        const idParam = params.find((p) => p.name === \"id\");\n        expect(idParam).toBeDefined();\n        expect(idParam?.type).toBe(\"string\");\n        expect(idParam?.description).toBe(\"Item ID\");\n        expect(idParam?.isRequired).toBe(true);\n\n        const countParam = params.find((p) => p.name === \"count\");\n        expect(countParam).toBeDefined();\n        expect(countParam?.type).toBe(\"number\");\n        expect(countParam?.isRequired).toBe(false);\n\n        const activeParam = params.find((p) => p.name === \"active\");\n        expect(activeParam).toBeDefined();\n        expect(activeParam?.type).toBe(\"boolean\");\n        expect(activeParam?.isRequired).toBe(false);\n      });\n\n      it(\"handles empty object schema\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({}),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n        expect(params).toHaveLength(0);\n      });\n\n      it(\"handles nested object schemas\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            user: z4\n              .object({\n                name: z4.string(),\n                email: z4.string(),\n              })\n              .describe(\"User info\"),\n            options: z4.object({\n              notify: z4.boolean(),\n            }),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n\n        const userParam = params.find((p) => p.name === \"user\");\n        expect(userParam).toBeDefined();\n        expect(userParam?.type).toBe(\"object\");\n        expect(userParam?.description).toBe(\"User info\");\n\n        const optionsParam = params.find((p) => p.name === \"options\");\n        expect(optionsParam).toBeDefined();\n        expect(optionsParam?.type).toBe(\"object\");\n      });\n\n      it(\"handles array properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            tags: z4.array(z4.string()).describe(\"List of tags\"),\n            items: z4.array(z4.object({ id: z4.number() })),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n\n        const tagsParam = params.find((p) => p.name === \"tags\");\n        expect(tagsParam).toBeDefined();\n        expect(tagsParam?.type).toBe(\"array\");\n        expect(tagsParam?.description).toBe(\"List of tags\");\n\n        const itemsParam = params.find((p) => p.name === \"items\");\n        expect(itemsParam).toBeDefined();\n        expect(itemsParam?.type).toBe(\"array\");\n      });\n    });\n\n    describe(\"realistic inputSchema scenarios\", () => {\n      it(\"handles enum properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            status: z4.enum([\"pending\", \"active\", \"completed\"]),\n            priority: z4\n              .enum([\"low\", \"medium\", \"high\"])\n              .describe(\"Task priority\"),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n\n        const statusParam = params.find((p) => p.name === \"status\");\n        expect(statusParam).toBeDefined();\n        expect(statusParam?.type).toBe(\"string\");\n        expect(statusParam?.isRequired).toBe(true);\n\n        const priorityParam = params.find((p) => p.name === \"priority\");\n        expect(priorityParam).toBeDefined();\n        expect(priorityParam?.type).toBe(\"string\");\n        expect(priorityParam?.description).toBe(\"Task priority\");\n      });\n\n      it(\"handles nullable properties\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            name: z4.string().nullable().describe(\"Optional name\"),\n            count: z4.number().nullable(),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n\n        const nameParam = params.find((p) => p.name === \"name\");\n        expect(nameParam).toBeDefined();\n        expect(nameParam?.description).toBe(\"Optional name\");\n        // Nullable fields are still required (they must be provided, even if null)\n        expect(nameParam?.isRequired).toBe(true);\n      });\n\n      it(\"handles deeply nested schemas and preserves full schema\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            config: z4.object({\n              database: z4.object({\n                host: z4.string(),\n                port: z4.number().optional(),\n              }),\n            }),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(1);\n        expect(params[0].name).toBe(\"config\");\n        expect(params[0].type).toBe(\"object\");\n        // The full nested schema should be preserved\n        expect(params[0].schema).toHaveProperty(\"properties\");\n      });\n\n      it(\"handles mixed required and optional fields correctly\", () => {\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: z4.object({\n            required1: z4.string(),\n            optional1: z4.string().optional(),\n            required2: z4.number(),\n          }),\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(3);\n\n        const required1 = params.find((p) => p.name === \"required1\");\n        const optional1 = params.find((p) => p.name === \"optional1\");\n        const required2 = params.find((p) => p.name === \"required2\");\n\n        expect(required1?.isRequired).toBe(true);\n        expect(optional1?.isRequired).toBe(false);\n        expect(required2?.isRequired).toBe(true);\n      });\n    });\n\n    describe(\"edge cases and error handling\", () => {\n      it(\"returns empty params when inputSchema is unknown type\", () => {\n        // Create a tool with an invalid inputSchema that isn't Standard Schema or JSON Schema\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: \"invalid-schema\" as any, // Not a valid schema\n          outputSchema: z4.void(),\n        };\n\n        const consoleSpy = jest.spyOn(console, \"warn\").mockImplementation();\n        const params = getParametersFromToolSchema(tool);\n        consoleSpy.mockRestore();\n\n        expect(params).toEqual([]);\n      });\n\n      it(\"handles JSON Schema with no properties field\", () => {\n        // Test the fallback: const properties = schema.properties ?? {};\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: {\n            type: \"object\",\n            // No properties field\n          } as JSONSchema7,\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n        expect(params).toEqual([]);\n      });\n\n      it(\"handles JSON Schema properties without descriptions\", () => {\n        // Test the fallback: propSchema.description ?? \"\"\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: {\n            type: \"object\",\n            properties: {\n              name: { type: \"string\" }, // No description\n              age: { type: \"number\" }, // No description\n            },\n          } as JSONSchema7,\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(2);\n        expect(params[0].description).toBe(\"\");\n        expect(params[1].description).toBe(\"\");\n      });\n\n      it(\"handles JSON Schema with non-object property values\", () => {\n        // Test the fallback: typeof propSchema === \"object\" && propSchema !== null ? propSchema : {}\n        const tool: TamboTool = {\n          name: \"test-tool\",\n          description: \"Test tool\",\n          tool: jest.fn(),\n          inputSchema: {\n            type: \"object\",\n            properties: {\n              // Properties can technically be boolean (for schema composition)\n              weird: true,\n            } as any,\n          } as JSONSchema7,\n          outputSchema: z4.void(),\n        };\n\n        const params = getParametersFromToolSchema(tool);\n\n        expect(params).toHaveLength(1);\n        expect(params[0].name).toBe(\"weird\");\n        expect(params[0].schema).toEqual({});\n      });\n    });\n  });\n\n  describe(\"schemaToJsonSchema\", () => {\n    it(\"returns JSON Schema as-is when already a JSON Schema\", () => {\n      const jsonSchema: JSONSchema7 = {\n        type: \"object\",\n        properties: {\n          name: { type: \"string\" },\n        },\n      };\n\n      const result = schemaToJsonSchema(jsonSchema);\n      expect(result).toBe(jsonSchema); // Same reference\n    });\n\n    it(\"converts Zod 4 schema to JSON Schema\", () => {\n      const zodSchema = z4.object({\n        name: z4.string(),\n        count: z4.number(),\n      });\n\n      const result = schemaToJsonSchema(zodSchema);\n\n      expect(result).toEqual(\n        expect.objectContaining({\n          type: \"object\",\n          properties: expect.objectContaining({\n            name: expect.objectContaining({ type: \"string\" }),\n            count: expect.objectContaining({ type: \"number\" }),\n          }),\n        }),\n      );\n    });\n\n    it(\"converts Zod 3 schema to JSON Schema\", () => {\n      const zodSchema = z3.object({\n        title: z3.string(),\n      });\n\n      const result = schemaToJsonSchema(zodSchema);\n\n      expect(result).toEqual(\n        expect.objectContaining({\n          type: \"object\",\n          properties: expect.objectContaining({\n            title: expect.objectContaining({ type: \"string\" }),\n          }),\n        }),\n      );\n    });\n  });\n\n  describe(\"safeSchemaToJsonSchema\", () => {\n    it(\"returns undefined for null schema\", () => {\n      expect(safeSchemaToJsonSchema(null)).toBeUndefined();\n    });\n\n    it(\"returns undefined for undefined schema\", () => {\n      expect(safeSchemaToJsonSchema(undefined)).toBeUndefined();\n    });\n\n    it(\"converts valid schema successfully\", () => {\n      const zodSchema = z4.object({ name: z4.string() });\n      const result = safeSchemaToJsonSchema(zodSchema);\n\n      expect(result).toEqual(\n        expect.objectContaining({\n          type: \"object\",\n          properties: expect.objectContaining({\n            name: expect.objectContaining({ type: \"string\" }),\n          }),\n        }),\n      );\n    });\n\n    it(\"returns undefined and calls onError for invalid schema\", () => {\n      // Create something that looks like a Standard Schema but will fail conversion\n      const brokenSchema = {\n        \"~standard\": {\n          version: 1,\n          vendor: \"broken\",\n          validate: () => ({ value: {} }),\n        },\n      };\n\n      const onError = jest.fn();\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      const result = safeSchemaToJsonSchema(brokenSchema as any, onError);\n\n      consoleSpy.mockRestore();\n\n      expect(result).toBeUndefined();\n      expect(onError).toHaveBeenCalled();\n    });\n\n    it(\"logs error to console when conversion fails\", () => {\n      const brokenSchema = {\n        \"~standard\": {\n          version: 1,\n          vendor: \"broken\",\n          validate: () => ({ value: {} }),\n        },\n      };\n\n      const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n      safeSchemaToJsonSchema(brokenSchema as any);\n\n      expect(consoleSpy).toHaveBeenCalledWith(\n        \"Error converting schema to JSON Schema:\",\n        expect.any(Error),\n      );\n\n      consoleSpy.mockRestore();\n    });\n  });\n});\n"]}