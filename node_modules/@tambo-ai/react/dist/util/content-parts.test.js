"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const content_parts_1 = require("./content-parts");
describe("content-parts type guards", () => {
    it("returns true for a valid text content part array", () => {
        const parts = [{ type: "text", text: "hello" }];
        expect((0, content_parts_1.isContentPartArray)(parts)).toBe(true);
    });
    it("returns true for a valid image_url content part array", () => {
        const parts = [
            { type: "image_url", image_url: { url: "data:image/png;base64,abc" } },
        ];
        expect((0, content_parts_1.isContentPartArray)(parts)).toBe(true);
    });
    it("returns false for non-object array elements", () => {
        const parts = ["text", 123, null];
        expect((0, content_parts_1.isContentPartArray)(parts)).toBe(false);
    });
    it("returns false when elements are objects without string type", () => {
        const parts = [{}, { type: 42 }, { type: undefined }];
        expect((0, content_parts_1.isContentPartArray)(parts)).toBe(false);
    });
    it("isContentPart narrows a single part", () => {
        const val = { type: "text", text: "hi" };
        if (!(0, content_parts_1.isContentPart)(val)) {
            throw new Error("should be content part");
        }
        // runtime spot-check
        expect(val.type).toBe("text");
    });
    it("returns false for non-array inputs", () => {
        expect((0, content_parts_1.isContentPartArray)({})).toBe(false);
        expect((0, content_parts_1.isContentPartArray)(null)).toBe(false);
        expect((0, content_parts_1.isContentPartArray)(undefined)).toBe(false);
        expect((0, content_parts_1.isContentPartArray)("foo")).toBe(false);
    });
    it("toText safely stringifies values and never throws", () => {
        expect((0, content_parts_1.toText)("hello")).toBe("hello");
        expect((0, content_parts_1.toText)(42)).toBe("42");
        const circular = { a: 1 };
        circular.self = circular;
        // Should not throw for circular structures
        expect(() => (0, content_parts_1.toText)(circular)).not.toThrow();
        expect(typeof (0, content_parts_1.toText)(undefined)).toBe("string");
    });
});
//# sourceMappingURL=content-parts.test.js.map