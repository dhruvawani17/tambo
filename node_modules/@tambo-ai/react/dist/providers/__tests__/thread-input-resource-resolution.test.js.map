{"version":3,"file":"thread-input-resource-resolution.test.js","sourceRoot":"","sources":["../../../src/providers/__tests__/thread-input-resource-resolution.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport { act, renderHook } from \"@testing-library/react\";\nimport React from \"react\";\nimport type TamboAI from \"@tambo-ai/typescript-sdk\";\nimport { ServerType } from \"../../mcp/mcp-constants\";\nimport type { McpServer } from \"../../mcp/tambo-mcp-provider\";\nimport { TamboProvider } from \"../tambo-provider\";\nimport { useTamboThreadInput } from \"../tambo-thread-input-provider\";\n\n// Mock the Tambo client provider to avoid needing real API credentials\n\njest.mock(\"../tambo-client-provider\", () => {\n  // eslint-disable-next-line @typescript-eslint/no-require-imports\n  const ReactModule = require(\"react\");\n  // eslint-disable-next-line @typescript-eslint/no-require-imports\n  const { QueryClient: QC } = require(\"@tanstack/react-query\");\n  const mockQueryClient = new QC();\n  const MockContext = ReactModule.createContext({\n    client: {},\n    queryClient: mockQueryClient,\n    isUpdatingToken: false,\n  });\n  return {\n    TamboClientProvider: ({ children }: { children: React.ReactNode }) => (\n      <MockContext.Provider\n        value={{\n          client: {},\n          queryClient: mockQueryClient,\n          isUpdatingToken: false,\n        }}\n      >\n        {children}\n      </MockContext.Provider>\n    ),\n    TamboClientContext: MockContext,\n    useTamboClient: () => ({\n      client: {},\n      queryClient: mockQueryClient,\n      isUpdatingToken: false,\n    }),\n  };\n});\n\n// Mock the thread provider to capture sendThreadMessage calls\nconst mockSendThreadMessage = jest.fn();\nconst mockContextKey = \"test-context-key\";\njest.mock(\"../tambo-thread-provider\", () => ({\n  TamboThreadProvider: ({ children }: { children: React.ReactNode }) =>\n    children,\n  useTamboThread: () => ({\n    thread: { id: \"test-thread-id\" },\n    sendThreadMessage: mockSendThreadMessage,\n    contextKey: mockContextKey,\n  }),\n}));\n\n// Mock servers array - will be updated per test\nlet mockServers: McpServer[] = [];\n\n// Mock the MCP provider to avoid real MCP connections\njest.mock(\"../../mcp/tambo-mcp-provider\", () => ({\n  TamboMcpProvider: ({ children }: { children: React.ReactNode }) => children,\n  useTamboMcpServers: () => mockServers,\n}));\n\n// Mock the MCP token provider\njest.mock(\"../tambo-mcp-token-provider\", () => ({\n  TamboMcpTokenProvider: ({ children }: { children: React.ReactNode }) =>\n    children,\n  useTamboMcpToken: () => ({\n    mcpAccessToken: null,\n    tamboBaseUrl: null,\n  }),\n}));\n\n// Helper to create internal server\nconst createMockInternalServer = (serverKey: string): McpServer =>\n  ({\n    key: serverKey,\n    serverKey,\n    url: \"https://api.tambo.ai/mcp\",\n    name: \"__tambo_internal_mcp_server__\",\n    transport: \"http\",\n    serverType: ServerType.TAMBO_INTERNAL,\n    connectionError: undefined, // Internal servers resolved by backend\n  }) as unknown as McpServer;\n\n// Mock the message images hook\njest.mock(\"../../hooks/use-message-images\", () => ({\n  useMessageImages: () => ({\n    images: [],\n    addImage: jest.fn(),\n    addImages: jest.fn(),\n    removeImage: jest.fn(),\n    clearImages: jest.fn(),\n  }),\n}));\n\n// Mock the mutation hook to execute the mutation function directly\njest.mock(\"../../hooks/react-query-hooks\", () => ({\n  useTamboMutation: ({ mutationFn }: { mutationFn: () => Promise<void> }) => ({\n    mutateAsync: mutationFn,\n    mutate: mutationFn,\n    isLoading: false,\n    isError: false,\n    isSuccess: false,\n    error: null,\n    reset: jest.fn(),\n  }),\n}));\n\ndescribe(\"TamboProvider - Resource Content Resolution Integration\", () => {\n  let queryClient: QueryClient;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockSendThreadMessage.mockResolvedValue(undefined);\n    // Default: no MCP servers (registry resources don't need a server entry)\n    mockServers = [];\n    queryClient = new QueryClient({\n      defaultOptions: {\n        queries: { retry: false },\n        mutations: { retry: false },\n      },\n    });\n  });\n\n  afterEach(() => {\n    queryClient.clear();\n    mockServers = [];\n  });\n\n  const createWrapper = (options?: {\n    listResources?: (\n      search?: string,\n    ) => Promise<{ uri: string; name: string; mimeType?: string }[]>;\n    getResource?: (uri: string) => Promise<unknown>;\n    resources?: { uri: string; name: string; mimeType?: string }[];\n  }) => {\n    function Wrapper({ children }: { children: React.ReactNode }) {\n      return (\n        <QueryClientProvider client={queryClient}>\n          <TamboProvider\n            apiKey=\"test-api-key\"\n            tamboUrl=\"https://api.tambo.ai\"\n            listResources={options?.listResources}\n            // Cast to any because test mocks return simplified types\n            getResource={options?.getResource as any}\n            resources={options?.resources}\n            contextKey={mockContextKey}\n          >\n            {children}\n          </TamboProvider>\n        </QueryClientProvider>\n      );\n    }\n    return Wrapper;\n  };\n\n  it(\"should resolve registry resource content when submitting a message\", async () => {\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [\n        {\n          uri: \"file:///my-document.txt\",\n          mimeType: \"text/plain\",\n          text: \"This is the document content from the registry\",\n        },\n      ],\n    });\n\n    const mockListResources = jest.fn().mockResolvedValue([\n      {\n        uri: \"file:///my-document.txt\",\n        name: \"My Document\",\n        mimeType: \"text/plain\",\n      },\n    ]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    // Set the input value with a registry resource reference\n    act(() => {\n      result.current.setValue(\n        \"Show me the contents of @registry:file:///my-document.txt in a table\",\n      );\n    });\n\n    // Submit the message\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // Verify getResource was called with the correct URI (without the registry: prefix)\n    expect(mockGetResource).toHaveBeenCalledWith(\"file:///my-document.txt\");\n\n    // Verify sendThreadMessage was called with the resolved content\n    expect(mockSendThreadMessage).toHaveBeenCalledTimes(1);\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    // Should have: text \"Show me the contents of \", resource with resolved content, text \" in a table\"\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Show me the contents of \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"mimeType\": \"text/plain\",\n            \"text\": \"This is the document content from the registry\",\n            \"uri\": \"file:///my-document.txt\",\n          },\n          \"type\": \"resource\",\n        },\n        {\n          \"text\": \" in a table\",\n          \"type\": \"text\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should resolve multiple registry resources in a single message\", async () => {\n    const mockGetResource = jest\n      .fn()\n      .mockImplementation(async (uri: string) => {\n        if (uri === \"file:///doc1.txt\") {\n          return { contents: [{ uri, text: \"Content of doc1\" }] };\n        }\n        if (uri === \"file:///doc2.txt\") {\n          return { contents: [{ uri, text: \"Content of doc2\" }] };\n        }\n        return null;\n      });\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\n        \"Compare @registry:file:///doc1.txt with @registry:file:///doc2.txt\",\n      );\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // Both resources should have been fetched\n    expect(mockGetResource).toHaveBeenCalledWith(\"file:///doc1.txt\");\n    expect(mockGetResource).toHaveBeenCalledWith(\"file:///doc2.txt\");\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Compare \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"text\": \"Content of doc1\",\n            \"uri\": \"file:///doc1.txt\",\n          },\n          \"type\": \"resource\",\n        },\n        {\n          \"text\": \" with \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"text\": \"Content of doc2\",\n            \"uri\": \"file:///doc2.txt\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should resolve registry resource with blob content\", async () => {\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [\n        {\n          uri: \"file:///image.png\",\n          mimeType: \"image/png\",\n          blob: \"base64encodedimagedata\",\n        },\n      ],\n    });\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\"Analyze @registry:file:///image.png\");\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Analyze \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"blob\": \"base64encodedimagedata\",\n            \"mimeType\": \"image/png\",\n            \"uri\": \"file:///image.png\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should continue with submission even if resource fetch fails (graceful fallback)\", async () => {\n    const consoleSpy = jest.spyOn(console, \"warn\").mockImplementation();\n    const mockGetResource = jest\n      .fn()\n      .mockRejectedValue(new Error(\"Resource fetch failed\"));\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\"Check @registry:file:///missing.txt\");\n    });\n\n    // Should not throw, should continue with submission\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // Resource fetch was attempted\n    expect(mockGetResource).toHaveBeenCalledWith(\"file:///missing.txt\");\n\n    // Warning should be logged\n    expect(consoleSpy).toHaveBeenCalledWith(\n      \"Failed to fetch resource content for registry:file:///missing.txt:\",\n      expect.any(Error),\n    );\n\n    // Message should still be sent (without the resolved content)\n    expect(mockSendThreadMessage).toHaveBeenCalledTimes(1);\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    // Resource should be present but without text/blob content\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Check \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"uri\": \"file:///missing.txt\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should NOT resolve internal server resources (serverType: TAMBO_INTERNAL)\", async () => {\n    // Add internal server to mock servers\n    mockServers = [createMockInternalServer(\"tambo-abc123\")];\n\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [{ uri: \"tambo:test://resource/1\", text: \"Should not fetch\" }],\n    });\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\n        \"Check @tambo-abc123:tambo:test://internal/resource/1\",\n      );\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // getResource should NOT be called for internal server resources\n    expect(mockGetResource).not.toHaveBeenCalled();\n\n    // Message should still be sent with resource (but without resolved content)\n    expect(mockSendThreadMessage).toHaveBeenCalledTimes(1);\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Check \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"uri\": \"tambo:test://internal/resource/1\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should handle mixed registry and internal server resources\", async () => {\n    // Add internal server\n    mockServers = [createMockInternalServer(\"tambo-xyz\")];\n\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [{ uri: \"file:///registry-doc.txt\", text: \"Registry content\" }],\n    });\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\n        \"@registry:file:///registry-doc.txt and @tambo-xyz:tambo:test://internal\",\n      );\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // Only the registry resource should be fetched\n    expect(mockGetResource).toHaveBeenCalledTimes(1);\n    expect(mockGetResource).toHaveBeenCalledWith(\"file:///registry-doc.txt\");\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"resource\": {\n            \"text\": \"Registry content\",\n            \"uri\": \"file:///registry-doc.txt\",\n          },\n          \"type\": \"resource\",\n        },\n        {\n          \"text\": \" and \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"uri\": \"tambo:test://internal\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should include resource names when provided in submit options\", async () => {\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [\n        {\n          uri: \"file:///doc.txt\",\n          text: \"Document content\",\n        },\n      ],\n    });\n\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\"Check @registry:file:///doc.txt\");\n    });\n\n    await act(async () => {\n      await result.current.submit({\n        resourceNames: {\n          \"registry:file:///doc.txt\": \"Important Document.txt\",\n        },\n      });\n    });\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Check \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"name\": \"Important Document.txt\",\n            \"text\": \"Document content\",\n            \"uri\": \"file:///doc.txt\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should handle message without any resource references\", async () => {\n    const mockGetResource = jest.fn();\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\"Just a regular message without resources\");\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // No resource fetch should happen\n    expect(mockGetResource).not.toHaveBeenCalled();\n\n    // Message should be sent as plain text\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Just a regular message without resources\",\n          \"type\": \"text\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should handle null returned from getResource\", async () => {\n    const mockGetResource = jest.fn().mockResolvedValue(null);\n    const mockListResources = jest.fn().mockResolvedValue([]);\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        listResources: mockListResources,\n        getResource: mockGetResource,\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\"Check @registry:file:///unknown.txt\");\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    expect(mockGetResource).toHaveBeenCalled();\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    // Resource should be present but without content\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Check \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"uri\": \"file:///unknown.txt\",\n          },\n          \"type\": \"resource\",\n        },\n      ]\n    `);\n  });\n\n  it(\"should warn when no resourceSource is available for registry resource\", async () => {\n    const consoleSpy = jest.spyOn(console, \"warn\").mockImplementation();\n\n    // No listResources/getResource provided\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper(),\n    });\n\n    act(() => {\n      result.current.setValue(\"Check @registry:file:///doc.txt\");\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    expect(consoleSpy).toHaveBeenCalledWith(\n      \"No resource source available to resolve registry resource: registry:file:///doc.txt\",\n    );\n\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should resolve static resources passed via resources prop\", async () => {\n    // When using static resources, we need both listResources and getResource\n    // to form the resourceSource, even though the resources are static\n    const mockGetResource = jest.fn().mockResolvedValue({\n      contents: [\n        {\n          uri: \"static://my-static-resource\",\n          text: \"Static resource content\",\n          mimeType: \"text/plain\",\n        },\n      ],\n    });\n\n    const { result } = renderHook(() => useTamboThreadInput(), {\n      wrapper: createWrapper({\n        resources: [\n          {\n            uri: \"static://my-static-resource\",\n            name: \"My Static Resource\",\n            mimeType: \"text/plain\",\n          },\n        ],\n        // Need getResource to actually fetch the content\n        getResource: mockGetResource,\n        listResources: async () => [],\n      }),\n    });\n\n    act(() => {\n      result.current.setValue(\n        \"Show me @registry:static://my-static-resource please\",\n      );\n    });\n\n    await act(async () => {\n      await result.current.submit();\n    });\n\n    // getResource should be called to fetch the content\n    expect(mockGetResource).toHaveBeenCalledWith(\"static://my-static-resource\");\n\n    const [, options] = mockSendThreadMessage.mock.calls[0];\n    const content =\n      options.content as TamboAI.Beta.Threads.ChatCompletionContentPart[];\n\n    expect(content).toMatchInlineSnapshot(`\n      [\n        {\n          \"text\": \"Show me \",\n          \"type\": \"text\",\n        },\n        {\n          \"resource\": {\n            \"mimeType\": \"text/plain\",\n            \"text\": \"Static resource content\",\n            \"uri\": \"static://my-static-resource\",\n          },\n          \"type\": \"resource\",\n        },\n        {\n          \"text\": \" please\",\n          \"type\": \"text\",\n        },\n      ]\n    `);\n  });\n});\n"]}