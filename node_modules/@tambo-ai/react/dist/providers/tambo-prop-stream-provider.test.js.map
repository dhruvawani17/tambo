{"version":3,"file":"tambo-prop-stream-provider.test.js","sourceRoot":"","sources":["../../src/providers/tambo-prop-stream-provider.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { render, screen } from \"@testing-library/react\";\nimport React from \"react\";\nimport { useTamboCurrentMessage } from \"../hooks/use-current-message\";\nimport {\n  GenerationStage,\n  TamboThreadMessage,\n} from \"../model/generate-component-response\";\nimport {\n  CombinedTamboThreadContextProps,\n  useTamboGenerationStage,\n  useTamboThread,\n} from \"../providers/tambo-thread-provider\";\nimport {\n  TamboPropStreamProvider,\n  useTamboStream,\n} from \"./tambo-prop-stream-provider\";\n\n// Mock the required providers\njest.mock(\"../providers/tambo-thread-provider\", () => ({\n  useTamboThread: jest.fn(),\n  useTamboGenerationStage: jest.fn(),\n}));\n\njest.mock(\"../hooks/use-current-message\", () => ({\n  useTamboCurrentMessage: jest.fn(),\n}));\n\n// Mock window for SSR tests\nconst originalWindow = global.window;\n\n// Helper function to create mock ComponentDecisionV2\nconst createMockComponent = (props: Record<string, unknown> = {}): any => ({\n  componentName: \"TestComponent\",\n  componentState: {},\n  message: \"Component generated\",\n  props,\n  reasoning: \"Test reasoning\",\n});\n\n// Helper function to create mock TamboThreadMessage\nconst createMockMessage = (\n  overrides: Partial<TamboThreadMessage> = {},\n): TamboThreadMessage => ({\n  id: \"test-message\",\n  componentState: {},\n  content: [{ type: \"text\", text: \"test content\" }],\n  createdAt: new Date().toISOString(),\n  role: \"assistant\",\n  threadId: \"test-thread\",\n  ...overrides,\n});\n\n// Helper function to create mock CombinedTamboThreadContextProps\nconst createMockThreadContext = (\n  overrides: Partial<CombinedTamboThreadContextProps> = {},\n): CombinedTamboThreadContextProps => {\n  const mockThread = {\n    id: \"test-thread\",\n    projectId: \"test-project\",\n    messages: [],\n    name: \"Test Thread\",\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n  };\n  return {\n    // TamboThreadContextProps properties\n    thread: mockThread,\n    currentThreadId: mockThread.id,\n    currentThread: mockThread,\n    threadMap: { [mockThread.id]: mockThread },\n    setThreadMap: jest.fn(),\n    switchCurrentThread: jest.fn(),\n    startNewThread: jest.fn(),\n    updateThreadName: jest.fn(),\n    generateThreadName: jest.fn(),\n    addThreadMessage: jest.fn(),\n    updateThreadMessage: jest.fn(),\n    cancel: jest.fn(),\n    streaming: false,\n    sendThreadMessage: jest.fn(),\n    // GenerationStageContextProps properties\n    generationStage: GenerationStage.IDLE,\n    generationStatusMessage: \"\",\n    isIdle: true,\n    ...overrides,\n  };\n};\n\n// Helper component to test hook usage\nconst TestHookComponent: React.FC<{ testKey?: string }> = ({\n  testKey = \"default\",\n}) => {\n  const { streamStatus, getStatusForKey } = useTamboStream();\n  const status = getStatusForKey(testKey);\n\n  return (\n    <div>\n      <div data-testid=\"stream-status\">{JSON.stringify(streamStatus)}</div>\n      <div data-testid=\"key-status\">{JSON.stringify(status)}</div>\n    </div>\n  );\n};\n\ndescribe(\"TamboPropStreamProvider\", () => {\n  beforeEach(() => {\n    // Restore window for client-side tests\n    global.window = originalWindow;\n\n    // Default mock implementations\n    jest.mocked(useTamboThread).mockReturnValue(createMockThreadContext());\n\n    jest.mocked(useTamboGenerationStage).mockReturnValue({\n      generationStage: GenerationStage.IDLE,\n      generationStatusMessage: \"\",\n      isIdle: true,\n    });\n\n    jest.mocked(useTamboCurrentMessage).mockReturnValue({\n      id: \"test-message\",\n      component: {\n        props: {},\n      },\n    } as TamboThreadMessage);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe(\"Hook Error Handling\", () => {\n    it(\"should throw error when useTamboStream is used outside provider\", () => {\n      // Suppress console.error for this test\n      const originalError = console.error;\n      console.error = jest.fn();\n\n      expect(() => {\n        render(<TestHookComponent />);\n      }).toThrow(\n        \"useTamboStream must be used within a TamboPropStreamProvider\",\n      );\n\n      console.error = originalError;\n    });\n  });\n\n  describe(\"Compound Components\", () => {\n    describe(\"Streaming Component\", () => {\n      it(\"should render streaming when isPending is true\", () => {\n        jest.mocked(useTamboThread).mockReturnValue(\n          createMockThreadContext({\n            generationStage: GenerationStage.IDLE,\n          }),\n        );\n\n        jest.mocked(useTamboGenerationStage).mockReturnValue({\n          generationStage: GenerationStage.IDLE,\n          generationStatusMessage: \"\",\n          isIdle: true,\n        });\n\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            component: createMockComponent({ title: \"\" }),\n          }),\n        );\n\n        render(\n          <TamboPropStreamProvider>\n            <TamboPropStreamProvider.Streaming>\n              <div data-testid=\"loading\">Loading...</div>\n            </TamboPropStreamProvider.Streaming>\n          </TamboPropStreamProvider>,\n        );\n\n        expect(screen.getByTestId(\"loading\")).toBeInTheDocument();\n      });\n\n      it(\"should render streaming when isStreaming is true\", () => {\n        jest.mocked(useTamboThread).mockReturnValue(\n          createMockThreadContext({\n            generationStage: GenerationStage.STREAMING_RESPONSE,\n          }),\n        );\n\n        jest.mocked(useTamboGenerationStage).mockReturnValue({\n          generationStage: GenerationStage.STREAMING_RESPONSE,\n          generationStatusMessage: \"\",\n          isIdle: false,\n        });\n\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            component: createMockComponent({ title: \"Partial\" }),\n          }),\n        );\n\n        render(\n          <TamboPropStreamProvider>\n            <TamboPropStreamProvider.Streaming>\n              <div data-testid=\"loading\">Loading...</div>\n            </TamboPropStreamProvider.Streaming>\n          </TamboPropStreamProvider>,\n        );\n\n        expect(screen.getByTestId(\"loading\")).toBeInTheDocument();\n      });\n    });\n\n    describe(\"Success Component\", () => {\n      it(\"should not render success when isSuccess is false\", () => {\n        jest.mocked(useTamboThread).mockReturnValue(\n          createMockThreadContext({\n            generationStage: GenerationStage.IDLE,\n          }),\n        );\n\n        jest.mocked(useTamboGenerationStage).mockReturnValue({\n          generationStage: GenerationStage.IDLE,\n          generationStatusMessage: \"\",\n          isIdle: true,\n        });\n\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            component: createMockComponent({ title: \"\" }),\n          }),\n        );\n\n        render(\n          <TamboPropStreamProvider>\n            <TamboPropStreamProvider.Success>\n              <div data-testid=\"complete\">Complete!</div>\n            </TamboPropStreamProvider.Success>\n          </TamboPropStreamProvider>,\n        );\n\n        expect(screen.queryByTestId(\"complete\")).not.toBeInTheDocument();\n      });\n    });\n\n    describe(\"Pending Component\", () => {\n      it(\"should render pending when no active status\", () => {\n        jest.mocked(useTamboThread).mockReturnValue(\n          createMockThreadContext({\n            generationStage: GenerationStage.IDLE,\n          }),\n        );\n\n        jest.mocked(useTamboGenerationStage).mockReturnValue({\n          generationStage: GenerationStage.IDLE,\n          generationStatusMessage: \"\",\n          isIdle: true,\n        });\n\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            component: createMockComponent({ title: \"\" }),\n          }),\n        );\n\n        render(\n          <TamboPropStreamProvider>\n            <TamboPropStreamProvider.Pending>\n              <div data-testid=\"empty\">Empty!</div>\n            </TamboPropStreamProvider.Pending>\n          </TamboPropStreamProvider>,\n        );\n\n        expect(screen.getByTestId(\"empty\")).toBeInTheDocument();\n      });\n\n      it(\"should not render pending when isPending is true\", () => {\n        jest.mocked(useTamboThread).mockReturnValue(\n          createMockThreadContext({\n            generationStage: GenerationStage.STREAMING_RESPONSE,\n          }),\n        );\n\n        jest.mocked(useTamboGenerationStage).mockReturnValue({\n          generationStage: GenerationStage.STREAMING_RESPONSE,\n          generationStatusMessage: \"\",\n          isIdle: false,\n        });\n\n        jest.mocked(useTamboCurrentMessage).mockReturnValue(\n          createMockMessage({\n            component: createMockComponent({ title: \"Partial\" }),\n          }),\n        );\n\n        render(\n          <TamboPropStreamProvider>\n            <TamboPropStreamProvider.Pending>\n              <div data-testid=\"empty\">Empty!</div>\n            </TamboPropStreamProvider.Pending>\n          </TamboPropStreamProvider>,\n        );\n\n        expect(screen.queryByTestId(\"empty\")).not.toBeInTheDocument();\n      });\n    });\n  });\n\n  describe(\"Key-based Status\", () => {\n    it(\"should provide status for keys not in propStatus\", () => {\n      jest.mocked(useTamboThread).mockReturnValue(\n        createMockThreadContext({\n          generationStage: GenerationStage.COMPLETE,\n        }),\n      );\n\n      jest.mocked(useTamboGenerationStage).mockReturnValue({\n        generationStage: GenerationStage.COMPLETE,\n        generationStatusMessage: \"\",\n        isIdle: false,\n      });\n\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(\n        createMockMessage({\n          component: createMockComponent({ name: \"John\" }),\n        }),\n      );\n\n      render(\n        <TamboPropStreamProvider>\n          <TestHookComponent testKey=\"nonexistent\" />\n        </TamboPropStreamProvider>,\n      );\n\n      const keyStatus = JSON.parse(\n        screen.getByTestId(\"key-status\").textContent,\n      );\n      expect(keyStatus.isPending).toBe(true);\n    });\n  });\n\n  describe(\"Compound Components with Keys\", () => {\n    it(\"should render loading for specific key when pending\", () => {\n      jest.mocked(useTamboThread).mockReturnValue(\n        createMockThreadContext({\n          generationStage: GenerationStage.STREAMING_RESPONSE,\n        }),\n      );\n\n      jest.mocked(useTamboGenerationStage).mockReturnValue({\n        generationStage: GenerationStage.STREAMING_RESPONSE,\n        generationStatusMessage: \"\",\n        isIdle: false,\n      });\n\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(\n        createMockMessage({\n          component: createMockComponent({\n            name: \"Partial\",\n            age: 25,\n          }),\n        }),\n      );\n\n      render(\n        <TamboPropStreamProvider>\n          <TamboPropStreamProvider.Streaming streamKey=\"name\">\n            <div data-testid=\"name-loading\">Name Loading...</div>\n          </TamboPropStreamProvider.Streaming>\n          <TamboPropStreamProvider.Streaming streamKey=\"age\">\n            <div data-testid=\"age-loading\">Age Loading...</div>\n          </TamboPropStreamProvider.Streaming>\n          <TamboPropStreamProvider.Success streamKey=\"name\">\n            <div data-testid=\"name-complete\">Name Complete!</div>\n          </TamboPropStreamProvider.Success>\n        </TamboPropStreamProvider>,\n      );\n\n      // Both props should be loading since they're in streaming stage\n      expect(screen.getByTestId(\"name-loading\")).toBeInTheDocument();\n      expect(screen.getByTestId(\"age-loading\")).toBeInTheDocument();\n      expect(screen.queryByTestId(\"name-complete\")).not.toBeInTheDocument();\n    });\n  });\n\n  describe(\"Styling\", () => {\n    it(\"should apply className to loading component\", () => {\n      jest.mocked(useTamboThread).mockReturnValue(\n        createMockThreadContext({\n          generationStage: GenerationStage.STREAMING_RESPONSE,\n        }),\n      );\n\n      jest.mocked(useTamboGenerationStage).mockReturnValue({\n        generationStage: GenerationStage.STREAMING_RESPONSE,\n        generationStatusMessage: \"\",\n        isIdle: false,\n      });\n\n      jest.mocked(useTamboCurrentMessage).mockReturnValue(\n        createMockMessage({\n          component: createMockComponent({ title: \"Partial\" }),\n        }),\n      );\n\n      render(\n        <TamboPropStreamProvider>\n          <TamboPropStreamProvider.Streaming className=\"loading-class\">\n            <div data-testid=\"loading\">Loading...</div>\n          </TamboPropStreamProvider.Streaming>\n        </TamboPropStreamProvider>,\n      );\n\n      const loadingElement = screen.getByTestId(\"loading\").parentElement;\n      expect(loadingElement).toHaveClass(\"loading-class\");\n    });\n  });\n});\n"]}