{"version":3,"file":"provider.js","sourceRoot":"","sources":["../../../src/providers/tambo-prop-stream-provider/provider.tsx"],"names":[],"mappings":";AAAA,YAAY,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEb,+CAMe;AACf,iFAA2E;AAC3E,mCAIiB;AAEjB,MAAM,sBAAsB,GAC1B,IAAA,qBAAa,EAAqC,IAAI,CAAC,CAAC;AAE1D;;;GAGG;AACI,MAAM,cAAc,GAAG,GAAgC,EAAE;IAC9D,MAAM,OAAO,GAAG,IAAA,kBAAU,EAAC,sBAAsB,CAAC,CAAC;IACnD,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,MAAM,IAAI,KAAK,CACb,8DAA8D,CAC/D,CAAC;IACJ,CAAC;IACD,OAAO,OAAO,CAAC;AACjB,CAAC,CAAC;AARW,QAAA,cAAc,kBAQzB;AAEF;;;;;;GAMG;AACH,MAAM,gCAAgC,GAAgC,CAAC,EACrE,QAAQ,GACT,EAAE,EAAE;IACH,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE,GAAG,IAAA,8CAAoB,GAAE,CAAC;IAE5D,MAAM,YAAY,GAAG,IAAA,eAAO,EAAC,GAAG,EAAE;QAChC,MAAM,GAAG,GAAG,IAAI,GAAG,EAAwB,CAAC;QAE5C,IAAI,UAAU,EAAE,CAAC;YACf,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,EAAE;gBACnD,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE;oBACX,SAAS,EAAE,MAAM,CAAC,SAAS;oBAC3B,WAAW,EAAE,MAAM,CAAC,WAAW;oBAC/B,SAAS,EAAE,MAAM,CAAC,SAAS;oBAC3B,OAAO,EAAE,CAAC,CAAC,MAAM,CAAC,KAAK;oBACvB,KAAK,EAAE,MAAM,CAAC,KAAK;iBACpB,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACL,CAAC;QAED,yCAAyC;QACzC,GAAG,CAAC,GAAG,CAAC,0BAAkB,EAAE;YAC1B,SAAS,EAAE,YAAY,CAAC,SAAS;YACjC,WAAW,EAAE,YAAY,CAAC,WAAW;YACrC,SAAS,EAAE,YAAY,CAAC,SAAS;YACjC,OAAO,EAAE,YAAY,CAAC,OAAO;YAC7B,KAAK,EAAE,YAAY,CAAC,WAAW;SAChC,CAAC,CAAC;QAEH,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC,CAAC;IAE/B,MAAM,eAAe,GAAG,IAAA,mBAAW,EACjC,CAAC,GAAW,EAAgB,EAAE;QAC5B,qDAAqD;QACrD,MAAM,UAAU,GAAG,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACzC,IAAI,UAAU,EAAE,CAAC;YACf,OAAO,UAAU,CAAC;QACpB,CAAC;QAED,0DAA0D;QAC1D,OAAO;YACL,SAAS,EAAE,IAAI;YACf,WAAW,EAAE,KAAK;YAClB,SAAS,EAAE,KAAK;YAChB,OAAO,EAAE,KAAK;SACf,CAAC;IACJ,CAAC,EACD,CAAC,YAAY,CAAC,CACf,CAAC;IAEF,MAAM,YAAY,GAAG,IAAA,eAAO,EAC1B,GAAgC,EAAE,CAAC,CAAC;QAClC,YAAY;QACZ,eAAe;KAChB,CAAC,EACF,CAAC,YAAY,EAAE,eAAe,CAAC,CAChC,CAAC;IAEF,OAAO,CACL,8BAAC,sBAAsB,CAAC,QAAQ,IAAC,KAAK,EAAE,YAAY,IACjD,QAAQ,CACuB,CACnC,CAAC;AACJ,CAAC,CAAC;AAEO,4EAAgC","sourcesContent":["\"use client\";\n\nimport React, {\n  createContext,\n  PropsWithChildren,\n  useCallback,\n  useContext,\n  useMemo,\n} from \"react\";\nimport { useTamboStreamStatus } from \"../../hooks/use-tambo-stream-status\";\nimport {\n  DEFAULT_STREAM_KEY,\n  StreamStatus,\n  TamboPropStreamContextValue,\n} from \"./types\";\n\nconst TamboPropStreamContext =\n  createContext<TamboPropStreamContextValue | null>(null);\n\n/**\n * Hook to use the TamboStream context\n * @returns The TamboStream context\n */\nexport const useTamboStream = (): TamboPropStreamContextValue => {\n  const context = useContext(TamboPropStreamContext);\n  if (!context) {\n    throw new Error(\n      \"useTamboStream must be used within a TamboPropStreamProvider\",\n    );\n  }\n  return context;\n};\n\n/**\n * The TamboStreamProvider provides a context for managing stream states\n * with compound components for Pending, Streaming, and Success states.\n * @param props - The props object\n * @param props.children - The children to wrap\n * @returns The TamboStreamProvider component\n */\nconst TamboPropStreamProviderComponent: React.FC<PropsWithChildren> = ({\n  children,\n}) => {\n  const { propStatus, streamStatus } = useTamboStreamStatus();\n\n  const keyStatusMap = useMemo(() => {\n    const map = new Map<string, StreamStatus>();\n\n    if (propStatus) {\n      Object.entries(propStatus).forEach(([key, status]) => {\n        map.set(key, {\n          isPending: status.isPending,\n          isStreaming: status.isStreaming,\n          isSuccess: status.isSuccess,\n          isError: !!status.error,\n          error: status.error,\n        });\n      });\n    }\n\n    // Always set default status for fallback\n    map.set(DEFAULT_STREAM_KEY, {\n      isPending: streamStatus.isPending,\n      isStreaming: streamStatus.isStreaming,\n      isSuccess: streamStatus.isSuccess,\n      isError: streamStatus.isError,\n      error: streamStatus.streamError,\n    });\n\n    return map;\n  }, [streamStatus, propStatus]);\n\n  const getStatusForKey = useCallback(\n    (key: string): StreamStatus => {\n      // If the key exists in propStatus, return its status\n      const propStatus = keyStatusMap.get(key);\n      if (propStatus) {\n        return propStatus;\n      }\n\n      // If key doesn't exist in propStatus, assume it's pending\n      return {\n        isPending: true,\n        isStreaming: false,\n        isSuccess: false,\n        isError: false,\n      };\n    },\n    [keyStatusMap],\n  );\n\n  const contextValue = useMemo(\n    (): TamboPropStreamContextValue => ({\n      streamStatus,\n      getStatusForKey,\n    }),\n    [streamStatus, getStatusForKey],\n  );\n\n  return (\n    <TamboPropStreamContext.Provider value={contextValue}>\n      {children}\n    </TamboPropStreamContext.Provider>\n  );\n};\n\nexport { TamboPropStreamProviderComponent };\n"]}