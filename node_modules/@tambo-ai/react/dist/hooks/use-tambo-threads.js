"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useTamboThreadList = useTamboThreadList;
const providers_1 = require("../providers");
const tambo_client_provider_1 = require("../providers/tambo-client-provider");
const react_query_hooks_1 = require("./react-query-hooks");
/**
 * Get all the threads for the specified project.
 *
 * If contextKey is empty, then all threads for the project will be returned.
 * If contextKey is not empty, then only the threads for the specified context
 * key will be returned. The contextKey is obtained from the TamboThreadProvider
 * via useTamboThread().
 * @param config - The config for the useTamboThreadList hook
 * @param config.projectId - The projectId to get the threads for
 * @returns The threads for the specified project and optional context key
 */
function useTamboThreadList({ projectId } = {}, options = {}) {
    const client = (0, tambo_client_provider_1.useTamboClient)();
    const { contextKey } = (0, providers_1.useTamboThread)();
    const { data: queriedProjectId, ...projectIdState } = (0, react_query_hooks_1.useTamboQuery)({
        ...options,
        queryKey: ["projectId"],
        queryFn: async () => {
            return (await client.beta.projects.getCurrent()).id;
        },
    });
    const currentProjectId = projectId ?? queriedProjectId;
    const threadState = (0, react_query_hooks_1.useTamboQuery)({
        ...options,
        enabled: !!currentProjectId,
        queryKey: ["threads", currentProjectId, contextKey],
        queryFn: async () => {
            if (!currentProjectId) {
                return null;
            }
            const threadIter = await client.beta.threads.list(currentProjectId, {
                contextKey,
            });
            return threadIter;
        },
    });
    return currentProjectId ? threadState : { data: null, ...projectIdState };
}
//# sourceMappingURL=use-tambo-threads.js.map