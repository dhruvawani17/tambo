"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useMessageImages = useMessageImages;
const react_1 = require("react");
/**
 * Hook for managing images in message input
 * @returns Object with images array and management functions
 */
function useMessageImages() {
    const [images, setImages] = (0, react_1.useState)([]);
    const fileToDataUrl = async (file) => {
        return await new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    };
    const addImage = (0, react_1.useCallback)(async (file) => {
        if (!file.type.startsWith("image/")) {
            throw new Error("Only image files are allowed");
        }
        const dataUrl = await fileToDataUrl(file);
        const newImage = {
            id: crypto.randomUUID(),
            name: file.name,
            dataUrl,
            file,
            size: file.size,
            type: file.type,
        };
        setImages((prev) => [...prev, newImage]);
    }, []);
    const addImages = (0, react_1.useCallback)(async (files) => {
        const imageFiles = files.filter((file) => file.type.startsWith("image/"));
        if (imageFiles.length === 0) {
            throw new Error("No valid image files provided");
        }
        const newImages = await Promise.all(imageFiles.map(async (file) => {
            const dataUrl = await fileToDataUrl(file);
            return {
                id: crypto.randomUUID(),
                name: file.name,
                dataUrl,
                file,
                size: file.size,
                type: file.type,
            };
        }));
        setImages((prev) => [...prev, ...newImages]);
    }, []);
    const removeImage = (0, react_1.useCallback)((id) => {
        setImages((prev) => prev.filter((img) => img.id !== id));
    }, []);
    const clearImages = (0, react_1.useCallback)(() => {
        setImages([]);
    }, []);
    return {
        images,
        addImage,
        addImages,
        removeImage,
        clearImages,
    };
}
//# sourceMappingURL=use-message-images.js.map