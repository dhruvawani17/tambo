"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const z3 = __importStar(require("zod/v3"));
const z4 = __importStar(require("zod/v4"));
const standard_schema_1 = require("./standard-schema");
describe("isStandardSchema", () => {
    describe("returns true for valid Standard Schema implementations", () => {
        it("recognizes Zod 4 object schema", () => {
            const schema = z4.object({ name: z4.string() });
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes Zod 3 object schema", () => {
            const schema = z3.object({ name: z3.string() });
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes Zod 4 string schema", () => {
            const schema = z4.string();
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes Zod 3 string schema", () => {
            const schema = z3.string();
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes Zod 4 array schema", () => {
            const schema = z4.array(z4.number());
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes Zod 3 array schema", () => {
            const schema = z3.array(z3.number());
            expect((0, standard_schema_1.isStandardSchema)(schema)).toBe(true);
        });
        it("recognizes custom object implementing Standard Schema v1", () => {
            const customSchema = {
                "~standard": {
                    version: 1,
                    vendor: "custom",
                    validate: () => ({ value: {} }),
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(customSchema)).toBe(true);
        });
    });
    describe("returns false for non-Standard Schema values", () => {
        it("rejects null", () => {
            expect((0, standard_schema_1.isStandardSchema)(null)).toBe(false);
        });
        it("rejects undefined", () => {
            expect((0, standard_schema_1.isStandardSchema)(undefined)).toBe(false);
        });
        it("rejects primitives", () => {
            expect((0, standard_schema_1.isStandardSchema)("string")).toBe(false);
            expect((0, standard_schema_1.isStandardSchema)(123)).toBe(false);
            expect((0, standard_schema_1.isStandardSchema)(true)).toBe(false);
        });
        it("rejects plain objects without ~standard", () => {
            expect((0, standard_schema_1.isStandardSchema)({ foo: "bar" })).toBe(false);
        });
        it("rejects JSON Schema objects", () => {
            const jsonSchema = {
                type: "object",
                properties: { name: { type: "string" } },
            };
            expect((0, standard_schema_1.isStandardSchema)(jsonSchema)).toBe(false);
        });
        it("rejects objects with ~standard that is not an object", () => {
            expect((0, standard_schema_1.isStandardSchema)({ "~standard": "invalid" })).toBe(false);
            expect((0, standard_schema_1.isStandardSchema)({ "~standard": 123 })).toBe(false);
            expect((0, standard_schema_1.isStandardSchema)({ "~standard": true })).toBe(false);
        });
        it("rejects objects with ~standard that is null", () => {
            expect((0, standard_schema_1.isStandardSchema)({ "~standard": null })).toBe(false);
        });
        it("rejects objects with wrong version", () => {
            const invalidVersion = {
                "~standard": {
                    version: 2, // Wrong version
                    vendor: "custom",
                    validate: () => ({ value: {} }),
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(invalidVersion)).toBe(false);
        });
        it("rejects objects with missing version", () => {
            const missingVersion = {
                "~standard": {
                    vendor: "custom",
                    validate: () => ({ value: {} }),
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(missingVersion)).toBe(false);
        });
        it("rejects objects with non-string vendor", () => {
            const invalidVendor = {
                "~standard": {
                    version: 1,
                    vendor: 123, // Not a string
                    validate: () => ({ value: {} }),
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(invalidVendor)).toBe(false);
        });
        it("rejects objects with missing vendor", () => {
            const missingVendor = {
                "~standard": {
                    version: 1,
                    validate: () => ({ value: {} }),
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(missingVendor)).toBe(false);
        });
        it("rejects objects with non-function validate", () => {
            const invalidValidate = {
                "~standard": {
                    version: 1,
                    vendor: "custom",
                    validate: "not-a-function",
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(invalidValidate)).toBe(false);
        });
        it("rejects objects with missing validate", () => {
            const missingValidate = {
                "~standard": {
                    version: 1,
                    vendor: "custom",
                },
            };
            expect((0, standard_schema_1.isStandardSchema)(missingValidate)).toBe(false);
        });
    });
});
//# sourceMappingURL=standard-schema.test.js.map