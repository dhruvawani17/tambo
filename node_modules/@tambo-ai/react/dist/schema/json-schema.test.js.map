{"version":3,"file":"json-schema.test.js","sourceRoot":"","sources":["../../src/schema/json-schema.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { JSONSchema7 } from \"json-schema\";\nimport {\n  getJsonSchemaTupleItems,\n  isJsonSchemaTuple,\n  JSONSchema7Extended,\n  looksLikeJSONSchema,\n  makeJsonSchemaPartial,\n} from \"./json-schema\";\n\ndescribe(\"looksLikeJSONSchema\", () => {\n  it(\"should return true for a valid object schema\", () => {\n    const schema = {\n      type: \"object\",\n      properties: {\n        name: { type: \"string\" },\n      },\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return true for a schema with only properties\", () => {\n    const schema = {\n      properties: {\n        name: { type: \"string\" },\n      },\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return true for a schema with items (array)\", () => {\n    const schema = {\n      type: \"array\",\n      items: { type: \"string\" },\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return true for a schema with enum\", () => {\n    const schema = {\n      enum: [\"a\", \"b\", \"c\"],\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return true for a schema with const\", () => {\n    const schema = {\n      const: \"fixed-value\",\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return true for a schema with $ref\", () => {\n    const schema = {\n      $ref: \"#/definitions/Person\",\n    };\n    expect(looksLikeJSONSchema(schema)).toBe(true);\n  });\n\n  it(\"should return false for null\", () => {\n    expect(looksLikeJSONSchema(null)).toBe(false);\n  });\n\n  it(\"should return false for non-object\", () => {\n    expect(looksLikeJSONSchema(\"string\")).toBe(false);\n    expect(looksLikeJSONSchema(123)).toBe(false);\n    expect(looksLikeJSONSchema(undefined)).toBe(false);\n  });\n\n  it(\"should return false for empty object\", () => {\n    expect(looksLikeJSONSchema({})).toBe(false);\n  });\n\n  it(\"should return false for object without schema keys\", () => {\n    const notSchema = {\n      foo: \"bar\",\n      baz: 123,\n    };\n    expect(looksLikeJSONSchema(notSchema)).toBe(false);\n  });\n});\n\ndescribe(\"isJsonSchemaTuple\", () => {\n  it(\"should return true for draft-07 tuple (items as array)\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      items: [{ type: \"string\" }, { type: \"number\" }],\n    };\n    expect(isJsonSchemaTuple(schema)).toBe(true);\n  });\n\n  it(\"should return true for draft 2020-12 tuple (prefixItems)\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      prefixItems: [{ type: \"string\" }, { type: \"number\" }],\n    };\n    expect(isJsonSchemaTuple(schema)).toBe(true);\n  });\n\n  it(\"should return false for regular array schema (items as object)\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      items: { type: \"string\" },\n    };\n    expect(isJsonSchemaTuple(schema)).toBe(false);\n  });\n\n  it(\"should return false for non-array schema\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"object\",\n      properties: {},\n    };\n    expect(isJsonSchemaTuple(schema)).toBe(false);\n  });\n\n  it(\"should return false for array without items or prefixItems\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n    };\n    expect(isJsonSchemaTuple(schema)).toBe(false);\n  });\n});\n\ndescribe(\"getJsonSchemaTupleItems\", () => {\n  it(\"should return items for draft-07 tuple\", () => {\n    const items = [{ type: \"string\" }, { type: \"number\" }];\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      items: items as JSONSchema7[],\n    };\n    expect(getJsonSchemaTupleItems(schema)).toEqual(items);\n  });\n\n  it(\"should return prefixItems for draft 2020-12 tuple\", () => {\n    const prefixItems = [{ type: \"string\" }, { type: \"number\" }];\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      prefixItems: prefixItems as JSONSchema7[],\n    };\n    expect(getJsonSchemaTupleItems(schema)).toEqual(prefixItems);\n  });\n\n  it(\"should return undefined for non-array schema\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"object\",\n    };\n    expect(getJsonSchemaTupleItems(schema)).toBeUndefined();\n  });\n\n  it(\"should return undefined for array without tuple items\", () => {\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      items: { type: \"string\" },\n    };\n    expect(getJsonSchemaTupleItems(schema)).toBeUndefined();\n  });\n\n  it(\"should prefer prefixItems over items when both present\", () => {\n    const prefixItems = [{ type: \"boolean\" }];\n    const items = [{ type: \"string\" }];\n    const schema: JSONSchema7Extended = {\n      type: \"array\",\n      prefixItems: prefixItems as JSONSchema7[],\n      items: items as JSONSchema7[],\n    };\n    expect(getJsonSchemaTupleItems(schema)).toEqual(prefixItems);\n  });\n});\n\ndescribe(\"makeJsonSchemaPartial\", () => {\n  it(\"should remove required array from schema\", () => {\n    const schema: JSONSchema7 = {\n      type: \"object\",\n      properties: {\n        name: { type: \"string\" },\n        age: { type: \"number\" },\n      },\n      required: [\"name\", \"age\"],\n    };\n\n    const partial = makeJsonSchemaPartial(schema);\n\n    expect(partial.required).toBeUndefined();\n    expect(partial.type).toBe(\"object\");\n    expect(partial.properties).toEqual(schema.properties);\n  });\n\n  it(\"should preserve all other properties\", () => {\n    const schema: JSONSchema7 = {\n      type: \"object\",\n      properties: {\n        name: { type: \"string\", description: \"The name\" },\n      },\n      required: [\"name\"],\n      additionalProperties: false,\n      description: \"A person schema\",\n      title: \"Person\",\n    };\n\n    const partial = makeJsonSchemaPartial(schema);\n\n    expect(partial.required).toBeUndefined();\n    expect(partial.type).toBe(\"object\");\n    expect(partial.properties).toEqual(schema.properties);\n    expect(partial.additionalProperties).toBe(false);\n    expect(partial.description).toBe(\"A person schema\");\n    expect(partial.title).toBe(\"Person\");\n  });\n\n  it(\"should handle schema without required array\", () => {\n    const schema: JSONSchema7 = {\n      type: \"object\",\n      properties: {\n        name: { type: \"string\" },\n      },\n    };\n\n    const partial = makeJsonSchemaPartial(schema);\n\n    expect(partial.required).toBeUndefined();\n    expect(partial.type).toBe(\"object\");\n    expect(partial.properties).toEqual(schema.properties);\n  });\n\n  it(\"should not mutate the original schema\", () => {\n    const schema: JSONSchema7 = {\n      type: \"object\",\n      properties: {\n        name: { type: \"string\" },\n      },\n      required: [\"name\"],\n    };\n\n    const partial = makeJsonSchemaPartial(schema);\n\n    // Original should be unchanged\n    expect(schema.required).toEqual([\"name\"]);\n    // Partial should not have required\n    expect(partial.required).toBeUndefined();\n  });\n});\n"]}