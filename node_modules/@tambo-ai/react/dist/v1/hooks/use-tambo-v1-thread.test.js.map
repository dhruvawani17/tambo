{"version":3,"file":"use-tambo-v1-thread.test.js","sourceRoot":"","sources":["../../../src/v1/hooks/use-tambo-v1-thread.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import TamboAI from \"@tambo-ai/typescript-sdk\";\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport { renderHook, waitFor } from \"@testing-library/react\";\nimport React from \"react\";\nimport { useTamboClient } from \"../../providers/tambo-client-provider\";\nimport { useTamboV1Thread } from \"./use-tambo-v1-thread\";\n\njest.mock(\"../../providers/tambo-client-provider\", () => ({\n  useTamboClient: jest.fn(),\n}));\n\ndescribe(\"useTamboV1Thread\", () => {\n  const mockThread = {\n    id: \"thread_123\",\n    runStatus: \"idle\",\n    messages: [],\n    createdAt: \"2024-01-01T00:00:00.000Z\",\n    updatedAt: \"2024-01-01T00:00:00.000Z\",\n  };\n\n  const mockThreadsApi = {\n    retrieve: jest.fn(),\n    list: jest.fn(),\n  };\n\n  const mockTamboAI = {\n    apiKey: \"\",\n    threads: mockThreadsApi,\n  } as unknown as TamboAI;\n\n  let queryClient: QueryClient;\n\n  function TestWrapper({ children }: { children: React.ReactNode }) {\n    return (\n      <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>\n    );\n  }\n\n  beforeEach(() => {\n    queryClient = new QueryClient({\n      defaultOptions: {\n        queries: {\n          retry: false,\n        },\n      },\n    });\n    jest.mocked(useTamboClient).mockReturnValue(mockTamboAI);\n    mockThreadsApi.retrieve.mockReset();\n  });\n\n  it(\"fetches thread by ID\", async () => {\n    mockThreadsApi.retrieve.mockResolvedValue(mockThread);\n\n    const { result } = renderHook(() => useTamboV1Thread(\"thread_123\"), {\n      wrapper: TestWrapper,\n    });\n\n    await waitFor(() => {\n      expect(result.current.data).toEqual(mockThread);\n    });\n\n    expect(mockThreadsApi.retrieve).toHaveBeenCalledWith(\"thread_123\");\n  });\n\n  it(\"handles loading state\", async () => {\n    let resolvePromise: (value: unknown) => void;\n    const promise = new Promise((resolve) => {\n      resolvePromise = resolve;\n    });\n    mockThreadsApi.retrieve.mockReturnValue(promise);\n\n    const { result } = renderHook(() => useTamboV1Thread(\"thread_123\"), {\n      wrapper: TestWrapper,\n    });\n\n    expect(result.current.isLoading).toBe(true);\n    expect(result.current.data).toBeUndefined();\n\n    resolvePromise!(mockThread);\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n  });\n\n  it(\"handles error state\", async () => {\n    const mockError = new Error(\"Thread not found\");\n    mockThreadsApi.retrieve.mockRejectedValue(mockError);\n\n    const { result } = renderHook(() => useTamboV1Thread(\"thread_123\"), {\n      wrapper: TestWrapper,\n    });\n\n    await waitFor(() => {\n      expect(result.current.isError).toBe(true);\n      expect(result.current.error).toBe(mockError);\n    });\n  });\n});\n"]}