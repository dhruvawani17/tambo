/**
 * Event Accumulation Logic for v1 Streaming API
 *
 * Implements a reducer that transforms AG-UI event streams into React state.
 * Used with useReducer to accumulate events into thread state.
 */
import type { AGUIEvent } from "@ag-ui/core";
import type { StreamingState, TamboV1Thread } from "../types/thread";
/**
 * Error thrown when an unreachable case is reached in a switch statement.
 * This indicates a programming error where not all cases were handled.
 */
export declare class UnreachableCaseError extends Error {
    constructor(value: never);
}
/**
 * Per-thread state managed by the stream reducer.
 * Tracks thread data, streaming status, and accumulating data.
 */
export interface ThreadState {
    thread: TamboV1Thread;
    streaming: StreamingState;
    /**
     * Accumulating tool call arguments as JSON strings (for streaming).
     * Maps tool call ID to accumulated JSON string.
     */
    accumulatingToolArgs: Map<string, string>;
}
/**
 * State managed by the stream reducer.
 * Maintains a map of all threads being tracked.
 */
export interface StreamState {
    /**
     * Map of thread ID to thread state
     */
    threadMap: Record<string, ThreadState>;
    /**
     * Current active thread ID (for UI context)
     */
    currentThreadId: string | null;
}
/**
 * Event action - dispatches an AG-UI event to update thread state.
 */
export interface EventAction {
    type: "EVENT";
    event: AGUIEvent;
    threadId: string;
}
/**
 * Initialize thread action - creates a new thread in the threadMap.
 */
export interface InitThreadAction {
    type: "INIT_THREAD";
    threadId: string;
    initialThread?: Partial<TamboV1Thread>;
}
/**
 * Set current thread action - changes the active thread.
 */
export interface SetCurrentThreadAction {
    type: "SET_CURRENT_THREAD";
    threadId: string | null;
}
/**
 * Start new thread action - atomically creates and switches to a new thread.
 * This prevents race conditions when multiple calls happen concurrently.
 */
export interface StartNewThreadAction {
    type: "START_NEW_THREAD";
    threadId: string;
    initialThread?: Partial<TamboV1Thread>;
}
/**
 * Action type for the stream reducer.
 */
export type StreamAction = EventAction | InitThreadAction | SetCurrentThreadAction | StartNewThreadAction;
/**
 * Create initial thread state for a new thread.
 * @param threadId - Unique thread identifier
 * @returns Initial thread state
 */
export declare function createInitialThreadState(threadId: string): ThreadState;
/**
 * Create initial stream state with empty threadMap.
 * @returns Initial stream state
 */
export declare function createInitialState(): StreamState;
/**
 * Stream reducer that accumulates events into thread state.
 *
 * This reducer handles all AG-UI events and Tambo custom events,
 * transforming them into immutable state updates per thread.
 * @param state - Current stream state
 * @param action - Action to process
 * @returns Updated stream state
 */
export declare function streamReducer(state: StreamState, action: StreamAction): StreamState;
//# sourceMappingURL=event-accumulator.d.ts.map