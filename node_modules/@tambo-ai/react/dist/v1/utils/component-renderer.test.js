"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const component_renderer_1 = require("./component-renderer");
// Test component that uses the content context
const ContextAwareComponent = () => {
    const context = (0, component_renderer_1.useV1ComponentContent)();
    return (react_1.default.createElement("div", { "data-testid": "context-aware" },
        react_1.default.createElement("span", { "data-testid": "componentId" }, context.componentId),
        react_1.default.createElement("span", { "data-testid": "threadId" }, context.threadId),
        react_1.default.createElement("span", { "data-testid": "messageId" }, context.messageId),
        react_1.default.createElement("span", { "data-testid": "componentName" }, context.componentName)));
};
describe("V1ComponentContentProvider", () => {
    it("provides context to child components", () => {
        (0, react_2.render)(react_1.default.createElement(component_renderer_1.V1ComponentContentProvider, { componentId: "comp_123", threadId: "thread_456", messageId: "msg_789", componentName: "TestComponent" },
            react_1.default.createElement(ContextAwareComponent, null)));
        expect(react_2.screen.getByTestId("componentId")).toHaveTextContent("comp_123");
        expect(react_2.screen.getByTestId("threadId")).toHaveTextContent("thread_456");
        expect(react_2.screen.getByTestId("messageId")).toHaveTextContent("msg_789");
        expect(react_2.screen.getByTestId("componentName")).toHaveTextContent("TestComponent");
    });
});
describe("useV1ComponentContent", () => {
    it("throws when used outside provider", () => {
        function TestConsumer() {
            (0, component_renderer_1.useV1ComponentContent)();
            return react_1.default.createElement("div", null, "Should not render");
        }
        // Suppress React error boundary logs
        const consoleSpy = jest.spyOn(console, "error").mockImplementation();
        expect(() => (0, react_2.render)(react_1.default.createElement(TestConsumer, null))).toThrow("useV1ComponentContent must be used within a rendered component");
        consoleSpy.mockRestore();
    });
    it("returns context when used within provider", () => {
        (0, react_2.render)(react_1.default.createElement(component_renderer_1.V1ComponentContentProvider, { componentId: "comp_test", threadId: "thread_test", messageId: "msg_test", componentName: "TestComp" },
            react_1.default.createElement(ContextAwareComponent, null)));
        expect(react_2.screen.getByTestId("componentId")).toHaveTextContent("comp_test");
    });
});
//# sourceMappingURL=component-renderer.test.js.map